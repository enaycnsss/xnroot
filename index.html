<!doctype html>
<html lang="id" class="h-full">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="origin" />
  <title>XnRoot - Perpangkatan &amp; Bentuk Akar</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="assets/js/supabase-service.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&amp;display=swap"
    rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Fredoka', sans-serif;
    }

    .gradient-bg {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    }

    .card-glass {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .badge-glow {
      animation: badgePulse 2s ease-in-out infinite;
    }

    @keyframes badgePulse {

      0%,
      100% {
        transform: scale(1);
        filter: brightness(1);
      }

      50% {
        transform: scale(1.05);
        filter: brightness(1.2);
      }
    }

    @keyframes badgePopup {
      0% {
        transform: scale(0) rotate(-180deg);
        opacity: 0;
      }

      100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
      }
    }

    .badge-popup {
      animation: badgePopup 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-slide-in {
      animation: slideIn 0.5s ease-out forwards;
    }

    .toast {
      animation: slideIn 0.3s ease-out;
    }

    .progress-bar {
      transition: width 0.3s ease;
    }

    .level-card {
      transition: all 0.3s ease;
    }

    .level-card:hover:not(.locked) {
      transform: scale(1.02);
    }

    .option-btn {
      transition: all 0.2s ease;
    }

    .option-btn:hover:not(:disabled) {
      transform: translateX(5px);
    }

    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
    }

    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }
    }

    .timer-warning {
      animation: pulse 1s ease-in-out infinite;
    }

    .phase-card {
      transition: all 0.3s ease;
    }

    .phase-card:hover {
      transform: translateY(-5px);
    }

    .frac {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      line-height: 1;
      font-size: 0.9em;
      vertical-align: middle;
    }

    .frac .num,
    .frac .den {
      padding: 0 0.12em;
      white-space: nowrap;
    }

    .frac .bar {
      width: 100%;
      border-top: 1px solid rgba(255, 255, 255, 0.7);
      margin: 0.1em 0;
    }

    sup.sup-frac {
      font-size: 0.7em;
      line-height: 1;
      vertical-align: super;
    }
  </style>
  <style>
    @view-transition {
      navigation: auto;
    }
  </style>
</head>

<body class="h-full gradient-bg text-white overflow-auto">
  <div id="app" class="min-h-full w-full"><!-- Badge Notification Popup -->
    <div id="badge-notification" class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50">
      <div class="card-glass rounded-2xl p-8 text-center badge-popup max-w-sm shadow-2xl">
        <p class="text-6xl mb-4" id="badge-icon-notif">ğŸ†</p>
        <p class="text-2xl font-bold mb-2 text-yellow-400">Badge Baru!</p>
        <p class="text-xl mb-2 font-bold" id="badge-name-notif">Explorer</p>
        <p class="text-sm text-gray-300" id="badge-desc-notif">Mendaftar dan memulai petualangan</p><button
          onclick="closeBadgeNotification()"
          class="mt-6 px-6 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-lg hover:opacity-90 transition-opacity font-bold">
          Lanjutkan! ğŸ¯ </button>
      </div>
    </div><!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2 max-w-sm"></div><!-- Loading Screen -->
    <div id="loading-screen" class="fixed inset-0 gradient-bg flex items-center justify-center z-50">
      <div class="text-center">
        <div class="w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mx-auto mb-4">
        </div>
        <p class="text-xl text-indigo-300">Memuat aplikasi...</p>
      </div>
    </div><!-- Navigation -->
    <nav class="sticky top-0 z-40 card-glass py-4 px-4 md:px-6">
      <div class="max-w-7xl mx-auto flex items-center justify-between">
        <div class="flex items-center gap-3">
          <h1 id="nav-title"
            class="text-2xl md:text-4xl font-bold bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent">
            XnRoot</h1>
        </div>
        <div class="flex items-center gap-1 md:gap-2 overflow-x-auto"><button onclick="showSection('home')"
            class="nav-btn px-2 md:px-4 py-2 rounded-lg hover:bg-white/10 transition-colors font-medium text-sm md:text-base whitespace-nowrap">
            <span class="text-xl md:text-2xl">ğŸ </span> <span class="hidden sm:inline">Beranda</span> </button> <button
            onclick="showSection('cptp')"
            class="nav-btn px-2 md:px-4 py-2 rounded-lg hover:bg-white/10 transition-colors font-medium text-sm md:text-base whitespace-nowrap">
            <span class="text-xl md:text-2xl">ğŸ“š</span> <span class="hidden sm:inline">CP/TP</span> </button> <button
            onclick="showSection('inquiry')"
            class="nav-btn px-2 md:px-4 py-2 rounded-lg hover:bg-white/10 transition-colors font-medium text-sm md:text-base whitespace-nowrap">
            <span class="text-xl md:text-2xl">ğŸ”¬</span> <span class="hidden sm:inline">Inkuiri</span> </button> <button
            onclick="showSection('guide')"
            class="nav-btn px-2 md:px-4 py-2 rounded-lg hover:bg-white/10 transition-colors font-medium text-sm md:text-base whitespace-nowrap">
            <span class="text-xl md:text-2xl">ğŸ“–</span> <span class="hidden sm:inline">Petunjuk</span> </button> <button
            onclick="showSection('leaderboard')"
            class="nav-btn px-2 md:px-4 py-2 rounded-lg hover:bg-white/10 transition-colors font-medium text-sm md:text-base whitespace-nowrap">
            <span class="text-xl md:text-2xl">ğŸ†</span> <span class="hidden sm:inline">Peringkat</span> </button>
          <button onclick="showSection('developer')"
            class="nav-btn px-2 md:px-4 py-2 rounded-lg hover:bg-white/10 transition-colors font-medium text-sm md:text-base whitespace-nowrap">
            <span class="text-xl md:text-2xl">ğŸ‘¨â€ğŸ’»</span> <span class="hidden sm:inline">Developer</span> </button>
          <div id="user-score"
            class="hidden lg:flex items-center gap-2 bg-gradient-to-r from-yellow-500/20 to-orange-500/20 px-3 py-2 rounded-full border border-yellow-500/30">
            <span class="text-xl">â­</span> <span id="total-score-display" class="text-lg font-bold">0</span>
          </div>
        </div>
      </div>
    </nav><!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 md:px-6 py-6 md:py-8"><!-- Home Section -->
      <section id="home-section" class="space-y-8"><!-- Welcome Banner -->
        <div class="card-glass rounded-3xl p-6 md:p-10 text-center animate-slide-in">
          <div class="text-6xl mb-4">
            ğŸ‘‹
          </div>
          <h2 id="welcome-title"
            class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent">
            Selamat Datang di XnRoot!</h2>
          <p id="welcome-desc" class="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto leading-relaxed">Petualangan
            matematika interaktif dengan pendekatan inkuiri. Pelajari perpangkatan dan bentuk akar sambil bermain!. Agar
            pengalaman belajarmu lebih maksimal, silakan baca terlebih dahulu Petunjuk Bermain pada menu Petunjuk ğŸ“–
            sebelum memulai</p>
        </div><!-- Learning Materials -->
        <div class="card-glass rounded-2xl p-6 md:p-8">
          <h3 class="text-3xl md:text-4xl font-bold mb-6 flex items-center gap-3"><span
              class="text-4xl md:text-5xl">ğŸ“</span> Materi Pembelajaran</h3><!-- Material Tabs -->
          <div class="flex flex-wrap gap-3 mb-6"><button onclick="showMaterial('dasar')"
              class="material-tab bg-purple-500 px-6 py-3 rounded-full text-base md:text-lg font-medium transition-all"
              data-tab="dasar"> Perpangkatan Dasar </button> <button onclick="showMaterial('nol')"
              class="material-tab bg-white/10 px-6 py-3 rounded-full text-base md:text-lg font-medium transition-all hover:bg-white/20"
              data-tab="nol"> Pangkat Nol &amp; Negatif </button> <button onclick="showMaterial('pecahan')"
              class="material-tab bg-white/10 px-6 py-3 rounded-full text-base md:text-lg font-medium transition-all hover:bg-white/20"
              data-tab="pecahan"> Pangkat Pecahan &amp; Akar </button>
          </div><!-- Video Section -->
          <div class="mb-6">
            <div class="flex items-center gap-3 mb-4"><span class="text-3xl md:text-4xl">ğŸ“º</span>
              <h4 class="text-2xl md:text-3xl font-bold">Video Pembelajaran</h4>
            </div>
            <div id="video-content"></div>
          </div><!-- Material Content -->
          <div class="mb-6">
            <div class="flex items-center gap-3 mb-4"><span class="text-3xl md:text-4xl">ğŸ“š</span>
              <h4 class="text-2xl md:text-3xl font-bold">Materi Interaktif</h4>
            </div>
            <div id="material-content" class="bg-black/20 rounded-xl p-6 md:p-8 text-base md:text-lg leading-relaxed">
              <!-- Content loaded dynamically -->
            </div>
          </div><!-- Interactive Explorer -->
          <div class="bg-gradient-to-r from-indigo-500/20 to-purple-500/20 rounded-xl p-6 border border-indigo-500/30">
            <h4 class="font-bold text-xl md:text-2xl mb-4 flex items-center gap-3"><span
                class="text-2xl md:text-3xl">ğŸ”¬</span> Eksplorasi Interaktif</h4><!-- Mode Selector -->
            <div class="flex flex-wrap gap-2 mb-6"><button onclick="setExplorerMode('basic')" id="mode-basic"
                class="explorer-mode-btn bg-indigo-500 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                Perpangkatan Dasar </button> <button onclick="setExplorerMode('zero-negative')" id="mode-zero-negative"
                class="explorer-mode-btn bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                Pangkat 0 &amp; Negatif </button> <button onclick="setExplorerMode('fraction-root')"
                id="mode-fraction-root"
                class="explorer-mode-btn bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                Pangkat Pecahan &amp; Akar </button>
            </div><!-- Basic Mode -->
            <div id="explorer-basic" class="explorer-content">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><label class="block text-base md:text-lg text-gray-300 mb-2" for="exp-base">Basis (a):</label>
                  <input type="number" id="exp-base" value="2"
                    class="w-full bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-lg text-white focus:outline-none focus:border-indigo-500"
                    onchange="calculateExponent()">
                </div>
                <div><label class="block text-base md:text-lg text-gray-300 mb-2" for="exp-power">Pangkat (n):</label>
                  <input type="number" id="exp-power" value="3"
                    class="w-full bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-lg text-white focus:outline-none focus:border-indigo-500"
                    onchange="calculateExponent()">
                </div>
              </div>
              <div class="mt-4 p-6 bg-black/30 rounded-lg text-center">
                <p class="text-2xl md:text-3xl lg:text-4xl font-bold" id="exp-result">2Â³ = 2 Ã— 2 Ã— 2 = 8</p>
                <p class="text-base md:text-lg text-gray-400 mt-3" id="exp-explanation">Artinya: 2 dikalikan dengan
                  dirinya sendiri sebanyak 3 kali</p>
              </div>
            </div><!-- Zero & Negative Mode -->
            <div id="explorer-zero-negative" class="explorer-content hidden">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><label class="block text-base md:text-lg text-gray-300 mb-2" for="zn-base">Basis (a):</label>
                  <input type="number" id="zn-base" value="2"
                    class="w-full bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-lg text-white focus:outline-none focus:border-yellow-500"
                    onchange="calculateZeroNegative()">
                </div>
                <div><label class="block text-base md:text-lg text-gray-300 mb-2" for="zn-power">Pangkat (n):</label>
                  <input type="number" id="zn-power" value="0" step="1"
                    class="w-full bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-lg text-white focus:outline-none focus:border-yellow-500"
                    onchange="calculateZeroNegative()">
                </div>
              </div>
              <div class="mt-4 space-y-3">
                <div class="p-6 bg-black/30 rounded-lg">
                  <p class="text-2xl md:text-3xl font-bold text-center mb-3" id="zn-result">2â»Â² = 1</p>
                  <p class="text-base md:text-lg text-gray-400 text-center" id="zn-explanation">Setiap bilangan (selain
                    0) pangkat 0 = 1</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3"><button
                    onclick="document.getElementById('zn-power').value = '0'; calculateZeroNegative()"
                    class="bg-blue-500/20 border border-blue-500/30 rounded-lg px-4 py-3 hover:bg-blue-500/30 transition-all">
                    <p class="font-bold text-blue-300">Pangkat 0</p>
                    <p class="text-sm text-gray-400">aâ° = 1</p>
                  </button> <button onclick="document.getElementById('zn-power').value = '-1'; calculateZeroNegative()"
                    class="bg-orange-500/20 border border-orange-500/30 rounded-lg px-4 py-3 hover:bg-orange-500/30 transition-all">
                    <p class="font-bold text-orange-300">Pangkat -1</p>
                    <p class="text-sm text-gray-400">aâ»Â¹ = 1/a</p>
                  </button> <button onclick="document.getElementById('zn-power').value = '-3'; calculateZeroNegative()"
                    class="bg-red-500/20 border border-red-500/30 rounded-lg px-4 py-3 hover:bg-red-500/30 transition-all">
                    <p class="font-bold text-red-300">Pangkat -3</p>
                    <p class="text-sm text-gray-400">aâ»â¿ = 1/aâ¿</p>
                  </button>
                </div>
              </div>
            </div><!-- Fraction & Root Mode -->
            <div id="explorer-fraction-root" class="explorer-content hidden">
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div><label class="block text-base md:text-lg text-gray-300 mb-2" for="fr-base">Basis (a):</label>
                  <input type="number" id="fr-base" value="16"
                    class="w-full bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-lg text-white focus:outline-none focus:border-purple-500"
                    onchange="calculateFractionRoot()">
                </div>
                <div><label class="block text-base md:text-lg text-gray-300 mb-2" for="fr-numerator">Pembilang
                    (m):</label> <input type="number" id="fr-numerator" value="1"
                    class="w-full bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-lg text-white focus:outline-none focus:border-purple-500"
                    onchange="calculateFractionRoot()">
                </div>
                <div><label class="block text-base md:text-lg text-gray-300 mb-2" for="fr-denominator">Penyebut
                    (n):</label> <input type="number" id="fr-denominator" value="2" min="1"
                    class="w-full bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-lg text-white focus:outline-none focus:border-purple-500"
                    onchange="calculateFractionRoot()">
                </div>
              </div>
              <div class="mt-4 space-y-3">
                <div class="p-6 bg-black/30 rounded-lg">
                  <p class="text-2xl md:text-3xl font-bold text-center mb-3" id="fr-result">16<sup
                      class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span
                          class="den">2</span></span></sup> = âˆš16 = 4</p>
                  <p class="text-base md:text-lg text-gray-400 text-center" id="fr-explanation">a<sup
                      class="sup-frac"><span class="frac"><span class="num">m</span><span class="bar"></span><span
                          class="den">n</span></span></sup> = <sup>n</sup>v(a<sup>m</sup>) atau
                    (<sup>n</sup>v(a))<sup>m</sup></p>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3"><button onclick="setFractionExample(16, 1, 2)"
                    class="bg-green-500/20 border border-green-500/30 rounded-lg px-3 py-3 hover:bg-green-500/30 transition-all">
                    <p class="font-bold text-green-300 text-sm">âˆš16</p>
                    <p class="text-xs text-gray-400">16<sup class="sup-frac"><span class="frac"><span
                            class="num">1</span><span class="bar"></span><span class="den">2</span></span></sup></p>
                  </button> <button onclick="setFractionExample(27, 1, 3)"
                    class="bg-blue-500/20 border border-blue-500/30 rounded-lg px-3 py-3 hover:bg-blue-500/30 transition-all">
                    <p class="font-bold text-blue-300 text-sm">Â³âˆš27</p>
                    <p class="text-xs text-gray-400">27<sup class="sup-frac"><span class="frac"><span
                            class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup></p>
                  </button> <button onclick="setFractionExample(8, 2, 3)"
                    class="bg-purple-500/20 border border-purple-500/30 rounded-lg px-3 py-3 hover:bg-purple-500/30 transition-all">
                    <p class="font-bold text-purple-300 text-sm">8<sup class="sup-frac"><span class="frac"><span
                            class="num">2</span><span class="bar"></span><span class="den">3</span></span></sup></p>
                    <p class="text-xs text-gray-400">(Â³âˆš8)Â²</p>
                  </button> <button onclick="setFractionExample(4, 3, 2)"
                    class="bg-pink-500/20 border border-pink-500/30 rounded-lg px-3 py-3 hover:bg-pink-500/30 transition-all">
                    <p class="font-bold text-pink-300 text-sm">4<sup class="sup-frac"><span class="frac"><span
                            class="num">3</span><span class="bar"></span><span class="den">2</span></span></sup></p>
                    <p class="text-xs text-gray-400">(âˆš4)Â³</p>
                  </button>
                </div>
                <div class="bg-purple-500/10 rounded-lg p-4 border border-purple-500/20">
                  <p class="text-sm font-semibold text-purple-300 mb-2">ğŸ’¡ Tips Perhitungan:</p>
                  <ul class="text-xs md:text-sm text-gray-300 space-y-1">
                    <li>â€¢ a<sup class="sup-frac"><span class="frac"><span class="num">1</span><span
                            class="bar"></span><span class="den">n</span></span></sup> = â¿âˆša (pangkat <span
                        class="frac"><span class="num">1</span><span class="bar"></span><span
                          class="den">n</span></span> sama dengan akar pangkat n)</li>
                    <li>â€¢ a<sup class="sup-frac"><span class="frac"><span class="num">m</span><span
                            class="bar"></span><span class="den">n</span></span></sup> = â¿âˆš(aáµ) = (â¿âˆša)áµ (bisa hitung
                      pangkat dulu atau akar dulu)</li>
                    <li>â€¢ Contoh: 8<sup class="sup-frac"><span class="frac"><span class="num">2</span><span
                            class="bar"></span><span class="den">3</span></span></sup> = Â³âˆš(8Â²) = Â³âˆš64 = 4 ATAU (Â³âˆš8)Â² =
                      2Â² = 4</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div><!-- Game Section -->
        <div class="card-glass rounded-2xl p-6 md:p-8">
          <h3 class="text-3xl md:text-4xl font-bold mb-3 flex items-center gap-3"><span
              class="text-4xl md:text-5xl">ğŸ®</span> Quest Arena - Tantangan Matematika</h3>
          <p class="text-lg md:text-xl text-gray-400 mb-6">Uji pemahamanmu dengan soal kontekstual! Kumpulkan badges dan
            raih skor tertinggi!</p><!-- Player Registration -->
          <div id="player-registration"
            class="mb-6 p-6 bg-gradient-to-r from-cyan-500/20 to-blue-500/20 rounded-xl border border-cyan-500/30">
            <h4 class="font-bold text-lg mb-4">ğŸ“ Daftar untuk Bermain</h4>
            <div class="flex flex-col sm:flex-row gap-3"><input type="text" id="player-name-input"
                placeholder="Masukkan nama kamu"
                class="flex-1 bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-cyan-500"
                maxlength="20"> <button onclick="registerPlayer()"
                class="bg-gradient-to-r from-cyan-500 to-blue-500 px-6 py-3 rounded-lg font-bold hover:opacity-90 transition-opacity">
                Mulai Petualangan! ğŸš€ </button>
            </div>
          </div><!-- Level Cards -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"><!-- Level 1 -->
            <div id="level-1-card"
              class="level-card bg-gradient-to-br from-green-500/20 to-emerald-500/20 rounded-xl p-6 border-2 border-green-500/30 cursor-pointer"
              onclick="startLevel(1)">
              <div class="flex items-center justify-between mb-4"><span class="text-4xl">ğŸ¯</span> <span
                  id="level-1-status" class="px-3 py-1 bg-green-500/30 rounded-full text-xs font-bold">Tersedia</span>
              </div>
              <h4 class="font-bold text-xl mb-2 text-green-300">Level 1</h4>
              <p class="text-lg font-medium mb-2">Perpangkatan Dasar</p>
              <p class="text-sm text-gray-400 mb-4">10 Soal â€¢ 5 menit/soal</p>
              <div class="flex items-center justify-between"><span class="text-sm text-gray-400">Skor:</span> <span
                  id="level-1-score" class="font-bold text-green-400">0/1000</span>
              </div>
              <div class="mt-2 h-2 bg-black/30 rounded-full overflow-hidden">
                <div id="level-1-progress" class="h-full bg-gradient-to-r from-green-500 to-emerald-500 progress-bar"
                  style="width: 0%"></div>
              </div>
            </div><!-- Level 2 -->
            <div id="level-2-card"
              class="level-card locked bg-gradient-to-br from-yellow-500/20 to-orange-500/20 rounded-xl p-6 border-2 border-yellow-500/30 opacity-50 cursor-not-allowed"
              onclick="startLevel(2)">
              <div class="flex items-center justify-between mb-4"><span class="text-4xl">ğŸ¯</span> <span
                  id="level-2-status" class="px-3 py-1 bg-gray-500/30 rounded-full text-xs font-bold">ğŸ”’ Terkunci</span>
              </div>
              <h4 class="font-bold text-xl mb-2 text-yellow-300">Level 2</h4>
              <p class="text-lg font-medium mb-2">Pangkat Nol &amp; Negatif</p>
              <p class="text-sm text-gray-400 mb-4">10 Soal â€¢ 5 menit/soal</p>
              <div class="flex items-center justify-between"><span class="text-sm text-gray-400">Skor:</span> <span
                  id="level-2-score" class="font-bold text-yellow-400">0/1000</span>
              </div>
              <div class="mt-2 h-2 bg-black/30 rounded-full overflow-hidden">
                <div id="level-2-progress" class="h-full bg-gradient-to-r from-yellow-500 to-orange-500 progress-bar"
                  style="width: 0%"></div>
              </div>
            </div><!-- Level 3 -->
            <div id="level-3-card"
              class="level-card locked bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-xl p-6 border-2 border-purple-500/30 opacity-50 cursor-not-allowed"
              onclick="startLevel(3)">
              <div class="flex items-center justify-between mb-4"><span class="text-4xl">ğŸ¯</span> <span
                  id="level-3-status" class="px-3 py-1 bg-gray-500/30 rounded-full text-xs font-bold">ğŸ”’ Terkunci</span>
              </div>
              <h4 class="font-bold text-xl mb-2 text-purple-300">Level 3</h4>
              <p class="text-lg font-medium mb-2">Pangkat Pecahan &amp; Akar</p>
              <p class="text-sm text-gray-400 mb-4">10 Soal â€¢ 5 menit/soal</p>
              <div class="flex items-center justify-between"><span class="text-sm text-gray-400">Skor:</span> <span
                  id="level-3-score" class="font-bold text-purple-400">0/1000</span>
              </div>
              <div class="mt-2 h-2 bg-black/30 rounded-full overflow-hidden">
                <div id="level-3-progress" class="h-full bg-gradient-to-r from-purple-500 to-pink-500 progress-bar"
                  style="width: 0%"></div>
              </div>
            </div>
          </div><!-- Badges Section -->
          <div class="p-6 bg-black/20 rounded-xl">
            <div class="flex items-center justify-between mb-4">
              <h4 class="font-bold text-lg flex items-center gap-2"><span>ğŸ†</span> Koleksi Badges <span
                  id="badge-count" class="text-sm text-gray-400">(0/17)</span></h4>
            </div>
            <p class="text-sm text-gray-400 mb-4">Kumpulkan badges dengan menyelesaikan aktivitas dan tantangan!</p>
            <div id="badges-container"
              class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4 mb-6">
              <!-- Badges rendered here -->
            </div><!-- Badge Legend -->
            <div
              class="p-4 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 rounded-lg border border-indigo-500/20">
              <p class="text-sm font-semibold mb-3 flex items-center gap-2"><span>ğŸ“‹</span> Cara Mendapat Badges:</p>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-xs text-gray-300">
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Explorer: Daftar akun</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Video Watcher: Tonton video</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Material Reader: Baca 3 materi</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Experimenter: 5x eksperimen</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Learner: Selesaikan Level 1</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Thinker: Selesaikan Level 2</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Master: Selesaikan Level 3</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Perfectionist: Skor 1000</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Champion: Skor = 900</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Speedster: Cepat + skor tinggi</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Comeback Kid: Ulangi level</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Three Star: Selesaikan 3 level</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Perfect Trilogy: =800 semua</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Inquiry Master: Baca inkuiri</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Persistent: Jawab 50 soal</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Accurate: 10 benar berturut</span>
                </div>
                <div class="flex items-center gap-2">
                  <span>âœ“</span> <span>Scholar: Baca CP/TP</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section><!-- CP/TP Section -->
      <section id="cptp-section" class="hidden space-y-6">
        <div class="card-glass rounded-2xl p-6 md:p-8">
          <h3 class="text-3xl md:text-4xl font-bold mb-6 flex items-center gap-3"><span class="text-4xl">ğŸ¯</span>
            Capaian Pembelajaran &amp; Tujuan Pembelajaran</h3><!-- Capaian Pembelajaran -->
          <div class="bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-xl p-6 border border-blue-500/30 mb-6">
            <h4 class="text-2xl md:text-3xl font-bold mb-4 text-cyan-300 flex items-center gap-2"><span>ğŸ“š</span>
              Capaian Pembelajaran (CP)</h4>
            <p class="text-base md:text-lg text-gray-300 leading-relaxed mb-4">Peserta didik dapat memahami,
              menggunakan, dan mengevaluasi konsep eksponen (bilangan berpangkat) dan bentuk akar dalam menyelesaikan
              masalah, termasuk masalah-masalah kontekstual.</p>
            <div class="bg-black/20 rounded-lg p-4">
              <p class="text-sm text-gray-400"><strong>Fase:</strong> E (Kelas X SMA/MA)</p>
              <p class="text-sm text-gray-400 mt-1"><strong>Mata Pelajaran:</strong> Matematika</p>
              <p class="text-sm text-gray-400 mt-1"><strong>Elemen:</strong> Bilangan</p>
            </div>
          </div><!-- Tujuan Pembelajaran -->
          <div class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-xl p-6 border border-purple-500/30">
            <h4 class="text-2xl md:text-3xl font-bold mb-4 text-purple-300 flex items-center gap-2"><span>ğŸ¯</span>
              Tujuan Pembelajaran (TP)</h4>
            <div class="space-y-4">
              <div class="bg-black/20 rounded-lg p-5">
                <div class="flex items-start gap-3">
                  <div
                    class="flex-shrink-0 w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center font-bold">
                    1
                  </div>
                  <div class="flex-1">
                    <h5 class="font-bold text-lg md:text-xl text-green-300 mb-2">Memahami Konsep Perpangkatan</h5>
                    <p class="text-sm md:text-base text-gray-300">Peserta didik dapat menjelaskan dan menggunakan notasi
                      perpangkatan, termasuk perpangkatan bilangan bulat positif, nol, dan negatif.</p>
                  </div>
                </div>
              </div>
              <div class="bg-black/20 rounded-lg p-5">
                <div class="flex items-start gap-3">
                  <div
                    class="flex-shrink-0 w-8 h-8 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center font-bold">
                    2
                  </div>
                  <div class="flex-1">
                    <h5 class="font-bold text-lg md:text-xl text-yellow-300 mb-2">Menerapkan Sifat-Sifat Eksponen</h5>
                    <p class="text-sm md:text-base text-gray-300">Peserta didik dapat menggunakan sifat-sifat operasi
                      pada bilangan berpangkat untuk menyederhanakan bentuk aljabar dan menyelesaikan masalah.</p>
                  </div>
                </div>
              </div>
              <div class="bg-black/20 rounded-lg p-5">
                <div class="flex items-start gap-3">
                  <div
                    class="flex-shrink-0 w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center font-bold">
                    3
                  </div>
                  <div class="flex-1">
                    <h5 class="font-bold text-lg md:text-xl text-purple-300 mb-2">Memahami Bentuk Akar dan Pangkat
                      Pecahan</h5>
                    <p class="text-sm md:text-base text-gray-300">Peserta didik dapat menjelaskan hubungan antara bentuk
                      akar dengan pangkat pecahan, serta melakukan operasi pada bentuk akar.</p>
                  </div>
                </div>
              </div>
              <div class="bg-black/20 rounded-lg p-5">
                <div class="flex items-start gap-3">
                  <div
                    class="flex-shrink-0 w-8 h-8 bg-gradient-to-br from-red-500 to-rose-500 rounded-full flex items-center justify-center font-bold">
                    4
                  </div>
                  <div class="flex-1">
                    <h5 class="font-bold text-lg md:text-xl text-red-300 mb-2">Menyelesaikan Masalah Kontekstual</h5>
                    <p class="text-sm md:text-base text-gray-300">Peserta didik dapat mengaplikasikan konsep
                      perpangkatan dan bentuk akar untuk menyelesaikan permasalahan nyata dalam kehidupan sehari-hari.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section><!-- Inquiry Section -->
      <section id="inquiry-section" class="hidden space-y-6">
        <div class="card-glass rounded-2xl p-6 md:p-8">
          <h3 class="text-3xl md:text-4xl font-bold mb-4 flex items-center gap-3"><span class="text-4xl">ğŸ”¬</span>
            Sintaks Model Pembelajaran Inkuiri</h3>
          <p class="text-base md:text-lg text-gray-400 mb-8">Pendekatan pembelajaran berbasis penyelidikan yang
            mendorong siswa untuk aktif menemukan konsep matematika secara mandiri.</p><!-- Inquiry Phases -->
          <div class="space-y-6"><!-- Phase 1 -->
            <div
              class="phase-card bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-xl p-6 border border-blue-500/30 cursor-pointer"
              onclick="togglePhase('phase1')">
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-xl md:text-2xl font-bold text-cyan-300 flex items-center gap-3"><span
                    class="text-3xl">1ï¸âƒ£</span> Orientasi Masalah</h4><span id="phase1-icon" class="text-2xl">ğŸ“‹</span>
              </div>
              <p class="text-sm md:text-base text-gray-300 mb-4">Guru menyajikan masalah kontekstual untuk memicu rasa
                ingin tahu siswa</p>
              <div id="phase1-content" class="hidden mt-4 space-y-3 bg-black/20 rounded-lg p-5">
                <p class="text-base md:text-lg text-white font-semibold">ğŸ“ Contoh Implementasi:</p>
                <p class="text-sm md:text-base text-gray-300">"Perhatikan pertumbuhan bakteri di laboratorium! Satu
                  bakteri membelah menjadi 2, kemudian 4, lalu 8... Berapa jumlahnya setelah 10 kali pembelahan?
                  Bagaimana cara menghitungnya dengan cepat?"</p>
                <div class="bg-blue-500/10 rounded-lg p-4 mt-3">
                  <p class="text-sm font-semibold text-cyan-300 mb-2">ğŸ¯ Tujuan Fase:</p>
                  <ul class="list-disc list-inside text-xs md:text-sm text-gray-300 space-y-1">
                    <li>Membangkitkan rasa ingin tahu siswa</li>
                    <li>Mengaitkan dengan pengalaman nyata</li>
                    <li>Merumuskan pertanyaan penelitian</li>
                  </ul>
                </div>
              </div>
            </div><!-- Phase 2 -->
            <div
              class="phase-card bg-gradient-to-r from-green-500/20 to-emerald-500/20 rounded-xl p-6 border border-green-500/30 cursor-pointer"
              onclick="togglePhase('phase2')">
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-xl md:text-2xl font-bold text-green-300 flex items-center gap-3"><span
                    class="text-3xl">2ï¸âƒ£</span> Merumuskan Hipotesis</h4><span id="phase2-icon"
                  class="text-2xl">ğŸ’­</span>
              </div>
              <p class="text-sm md:text-base text-gray-300 mb-4">Siswa membuat dugaan sementara tentang pola atau aturan
                yang berlaku</p>
              <div id="phase2-content" class="hidden mt-4 space-y-3 bg-black/20 rounded-lg p-5">
                <p class="text-base md:text-lg text-white font-semibold">ğŸ“ Contoh Implementasi:</p>
                <p class="text-sm md:text-base text-gray-300">Siswa berhipotesis: "Mungkin ada pola perkalian berulang
                  di sini. Sepertinya kita mengalikan 2 sebanyak n kali untuk pembelahan ke-n."</p>
                <div class="bg-green-500/10 rounded-lg p-4 mt-3">
                  <p class="text-sm font-semibold text-green-300 mb-2">ğŸ¯ Tujuan Fase:</p>
                  <ul class="list-disc list-inside text-xs md:text-sm text-gray-300 space-y-1">
                    <li>Melatih berpikir logis dan prediksi</li>
                    <li>Mengembangkan kemampuan analisis</li>
                    <li>Membangun pemahaman awal konsep</li>
                  </ul>
                </div>
              </div>
            </div><!-- Phase 3 -->
            <div
              class="phase-card bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-xl p-6 border border-yellow-500/30 cursor-pointer"
              onclick="togglePhase('phase3')">
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-xl md:text-2xl font-bold text-yellow-300 flex items-center gap-3"><span
                    class="text-3xl">3ï¸âƒ£</span> Mengumpulkan Data</h4><span id="phase3-icon" class="text-2xl">ğŸ“Š</span>
              </div>
              <p class="text-sm md:text-base text-gray-300 mb-4">Siswa melakukan eksplorasi dan mengumpulkan informasi
                untuk menguji hipotesis</p>
              <div id="phase3-content" class="hidden mt-4 space-y-3 bg-black/20 rounded-lg p-5">
                <p class="text-base md:text-lg text-white font-semibold">ğŸ“ Contoh Implementasi:</p>
                <p class="text-sm md:text-base text-gray-300">Siswa menggunakan kalkulator eksplorasi untuk mencoba
                  berbagai basis dan pangkat: 2Â³, 2â´, 2âµ... Mereka mencatat pola hasilnya dan membandingkan dengan
                  hipotesis awal.</p>
                <div class="bg-yellow-500/10 rounded-lg p-4 mt-3">
                  <p class="text-sm font-semibold text-yellow-300 mb-2">ğŸ¯ Tujuan Fase:</p>
                  <ul class="list-disc list-inside text-xs md:text-sm text-gray-300 space-y-1">
                    <li>Mengumpulkan data secara sistematis</li>
                    <li>Menggunakan alat bantu (kalkulator, tabel)</li>
                    <li>Mengorganisir informasi yang ditemukan</li>
                  </ul>
                </div>
              </div>
            </div><!-- Phase 4 -->
            <div
              class="phase-card bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-xl p-6 border border-purple-500/30 cursor-pointer"
              onclick="togglePhase('phase4')">
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-xl md:text-2xl font-bold text-purple-300 flex items-center gap-3"><span
                    class="text-3xl">4ï¸âƒ£</span> Menguji Hipotesis</h4><span id="phase4-icon" class="text-2xl">ğŸ§ª</span>
              </div>
              <p class="text-sm md:text-base text-gray-300 mb-4">Siswa menganalisis data dan menguji kebenaran hipotesis
                yang telah dibuat</p>
              <div id="phase4-content" class="hidden mt-4 space-y-3 bg-black/20 rounded-lg p-5">
                <p class="text-base md:text-lg text-white font-semibold">ğŸ“ Contoh Implementasi:</p>
                <p class="text-sm md:text-base text-gray-300">"Mari kita cek: 2Â³ = 8 âœ“, 2â´ = 16 âœ“, 2âµ = 32 âœ“. Pola
                  terbukti! Notasi an memang berarti mengalikan a sebanyak n kali. Hipotesis kita benar!"</p>
                <div class="bg-purple-500/10 rounded-lg p-4 mt-3">
                  <p class="text-sm font-semibold text-purple-300 mb-2">ğŸ¯ Tujuan Fase:</p>
                  <ul class="list-disc list-inside text-xs md:text-sm text-gray-300 space-y-1">
                    <li>Memvalidasi atau merevisi hipotesis</li>
                    <li>Menggunakan bukti untuk argumentasi</li>
                    <li>Mengembangkan pemikiran kritis</li>
                  </ul>
                </div>
              </div>
            </div><!-- Phase 5 -->
            <div
              class="phase-card bg-gradient-to-r from-red-500/20 to-rose-500/20 rounded-xl p-6 border border-red-500/30 cursor-pointer"
              onclick="togglePhase('phase5')">
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-xl md:text-2xl font-bold text-red-300 flex items-center gap-3"><span
                    class="text-3xl">5ï¸âƒ£</span> Merumuskan Kesimpulan</h4><span id="phase5-icon"
                  class="text-2xl">ğŸ“</span>
              </div>
              <p class="text-sm md:text-base text-gray-300 mb-4">Siswa menarik kesimpulan berdasarkan hasil investigasi
                dan menghubungkan dengan konsep matematika</p>
              <div id="phase5-content" class="hidden mt-4 space-y-3 bg-black/20 rounded-lg p-5">
                <p class="text-base md:text-lg text-white font-semibold">ğŸ“ Contoh Implementasi:</p>
                <p class="text-sm md:text-base text-gray-300">"Kesimpulan: Perpangkatan an adalah operasi perkalian
                  berulang dimana a dikalikan dengan dirinya sendiri sebanyak n kali. Konsep ini sangat berguna untuk
                  menghitung pertumbuhan eksponensial seperti populasi bakteri, bunga bank, dan teknologi."</p>
                <div class="bg-red-500/10 rounded-lg p-4 mt-3">
                  <p class="text-sm font-semibold text-red-300 mb-2">ğŸ¯ Tujuan Fase:</p>
                  <ul class="list-disc list-inside text-xs md:text-sm text-gray-300 space-y-1">
                    <li>Membangun konsep matematika yang solid</li>
                    <li>Menghubungkan dengan konteks nyata</li>
                    <li>Mengkomunikasikan temuan secara jelas</li>
                  </ul>
                </div>
              </div>
            </div>
          </div><!-- Inquiry Benefits -->
          <div
            class="mt-8 bg-gradient-to-r from-indigo-500/20 to-purple-500/20 rounded-xl p-6 border border-indigo-500/30">
            <h4 class="text-xl md:text-2xl font-bold mb-4 flex items-center gap-2"><span>ğŸŒŸ</span> Manfaat Pembelajaran
              Inkuiri</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="bg-black/20 rounded-lg p-4">
                <p class="font-semibold text-indigo-300 mb-2">ğŸ§  Pengembangan Kognitif</p>
                <p class="text-sm text-gray-300">Melatih berpikir kritis, analitis, dan pemecahan masalah secara mandiri
                </p>
              </div>
              <div class="bg-black/20 rounded-lg p-4">
                <p class="font-semibold text-purple-300 mb-2">âš¡ Pembelajaran Aktif</p>
                <p class="text-sm text-gray-300">Siswa menjadi pusat pembelajaran dan aktif mengkonstruksi pengetahuan
                </p>
              </div>
              <div class="bg-black/20 rounded-lg p-4">
                <p class="font-semibold text-pink-300 mb-2">ğŸ“š Pemahaman Mendalam</p>
                <p class="text-sm text-gray-300">Konsep dipahami lebih dalam karena ditemukan sendiri, bukan dihafal</p>
              </div>
              <div class="bg-black/20 rounded-lg p-4">
                <p class="font-semibold text-cyan-300 mb-2">ğŸ”— Kontekstual</p>
                <p class="text-sm text-gray-300">Menghubungkan matematika dengan kehidupan nyata dan aplikasinya</p>
              </div>
            </div>
          </div>
        </div>
      </section><!-- Guide Section -->
      <section id="guide-section" class="hidden space-y-6">
        <div class="card-glass rounded-2xl p-6 md:p-8">
          <h3 class="text-2xl font-bold mb-6 flex items-center gap-3"><span class="text-3xl">ğŸ“–</span> Petunjuk Bermain
          </h3>
          <div class="space-y-4">
            <div class="bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-xl p-4 border border-blue-500/30">
              <h4 class="font-bold text-lg mb-2 flex items-center gap-2"><span>1ï¸âƒ£</span> Daftar</h4>
              <p class="text-gray-300">Masukkan nama kamu dan klik "Mulai Petualangan!" untuk memulai.</p>
            </div>
            <div class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-xl p-4 border border-purple-500/30">
              <h4 class="font-bold text-lg mb-2 flex items-center gap-2"><span>2ï¸âƒ£</span> Pelajari Materi</h4>
              <p class="text-gray-300">Tonton video dan baca materi pembelajaran untuk memahami konsep perpangkatan dan
                bentuk akar.</p>
            </div>
            <div class="bg-gradient-to-r from-green-500/20 to-emerald-500/20 rounded-xl p-4 border border-green-500/30">
              <h4 class="font-bold text-lg mb-2 flex items-center gap-2"><span>3ï¸âƒ£</span> Mainkan Level</h4>
              <p class="text-gray-300">Selesaikan setiap level dengan menjawab 10 soal. Setiap jawaban benar mendapat
                100 poin. Kecepatan juga dihitung!</p>
            </div>
            <div
              class="bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-xl p-4 border border-yellow-500/30">
              <h4 class="font-bold text-lg mb-2 flex items-center gap-2"><span>4ï¸âƒ£</span> Kumpulkan Badges</h4>
              <p class="text-gray-300">Dapatkan 17 badges berbeda dengan menyelesaikan berbagai aktivitas dan tantangan!
              </p>
            </div>
          </div>
          <div class="mt-8 space-y-6">
            <h4 class="text-xl md:text-2xl font-bold text-indigo-300 flex items-center gap-2"><span>ğŸ§­</span> Petunjuk
              Fitur</h4>
            <div
              class="phase-card bg-gradient-to-r from-cyan-500/20 to-blue-500/20 rounded-xl p-6 border border-cyan-500/30 cursor-pointer"
              onclick="toggleGuideItem('guide-exploration')">
              <div class="flex items-center justify-between mb-3">
                <h5 class="text-lg md:text-xl font-bold text-cyan-300">FITUR EKSPLORASI INTERAKTIF</h5>
                <span id="guide-exploration-icon" class="text-2xl">â•</span>
              </div>
              <p class="text-sm md:text-base text-gray-300">Digunakan untuk memahami konsep perpangkatan dan akar
                melalui
                percobaan langsung.</p>
              <div id="guide-exploration-content" class="hidden mt-4 bg-black/20 rounded-lg p-5">
                <p class="text-sm md:text-base text-white font-semibold mb-3">Langkah:</p>
                <ol class="list-decimal list-inside space-y-1 text-sm md:text-base text-gray-300">
                  <li>Pilih menu Eksplorasi Interaktif</li>
                  <li>Pilih materi</li>
                  <li>Masukkan angka</li>
                  <li>Amati hasil</li>
                </ol>
              </div>
            </div>
            <div
              class="phase-card bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-xl p-6 border border-purple-500/30 cursor-pointer"
              onclick="toggleGuideItem('guide-game')">
              <div class="flex items-center justify-between mb-3">
                <h5 class="text-lg md:text-xl font-bold text-purple-300">FITUR GAME LEVEL</h5>
                <span id="guide-game-icon" class="text-2xl">â•</span>
              </div>
              <p class="text-sm md:text-base text-gray-300">Digunakan untuk menguji pemahaman materi.</p>
              <div id="guide-game-content" class="hidden mt-4 bg-black/20 rounded-lg p-5">
                <p class="text-sm md:text-base text-white font-semibold mb-3">Langkah:</p>
                <ol class="list-decimal list-inside space-y-1 text-sm md:text-base text-gray-300">
                  <li>Log in dengan memasukkan username kalian</li>
                  <li>Pilih Game Level</li>
                  <li>Pilih level</li>
                  <li>Jawab soal</li>
                  <li>Lihat skor</li>
                </ol>
              </div>
            </div>
          </div>
        </div>
      </section><!-- Leaderboard Section -->
      <section id="leaderboard-section" class="hidden">
        <div class="card-glass rounded-2xl p-6 md:p-8">
          <h3 class="text-2xl font-bold mb-6 flex items-center gap-3"><span class="text-3xl">ğŸ†</span> Papan Peringkat
          </h3>
          <div id="leaderboard-content" class="space-y-3"><!-- Leaderboard rendered here -->
          </div>
        </div>
      </section><!-- Developer Section -->
      <section id="developer-section" class="hidden space-y-6">
        <div class="card-glass rounded-2xl p-6 md:p-8">
          <h3 class="text-3xl md:text-4xl font-bold mb-6 flex items-center gap-3"><span class="text-4xl">ğŸ‘¨â€ğŸ’»</span>
            Profil Pengembang</h3><!-- Developer Card -->
          <div
            class="bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-2xl p-8 border border-indigo-500/30 mb-6">
            <div class="flex flex-col md:flex-row items-center md:items-start gap-6">
              <div class="w-32 h-32 rounded-full bg-gradient-to-br from-cyan-500 to-purple-500 p-1 shadow-2xl">
                <img src="assets/images/Profil_biografi.jpg" alt="Foto pengembang"
                  class="w-full h-full rounded-full object-cover" loading="lazy">
              </div>
              <div class="flex-1 text-center md:text-left">
                <h4 class="text-2xl md:text-3xl font-bold text-indigo-300 mb-2">Nayla Fitria Novindra</h4>
                <p class="text-lg md:text-xl text-purple-300 mb-4">Mahasiswa Pendidikan Matematika</p>
                <div class="space-y-2 text-sm md:text-base text-gray-300">
                  <p class="flex items-center gap-2 justify-center md:justify-start"><span>ğŸ«</span> <span>Universitas
                      Muhammadiyah Metro (UMM)</span></p>
                  <p class="flex items-center gap-2 justify-center md:justify-start"><span>ğŸ“š</span> <span>Prodi
                      Pendidikan Matematika</span></p>
                  <p class="flex items-center gap-2 justify-center md:justify-start"><span>ğŸ“…</span> <span>Angkatan
                      2022</span></p>
                </div>
              </div>
            </div>
          </div><!-- Project Info -->
          <div
            class="bg-gradient-to-r from-green-500/20 to-emerald-500/20 rounded-xl p-6 border border-green-500/30 mb-6">
            <h4 class="text-xl md:text-2xl font-bold mb-4 text-green-300 flex items-center gap-2"><span>ğŸ“</span>
              Tentang Proyek</h4>
            <p class="text-sm md:text-base text-gray-300 leading-relaxed">XnRoot adalah aplikasi pembelajaran matematika
              interaktif yang dikembangkan dengan pendekatan model pembelajaran inkuiri. Aplikasi ini dirancang untuk
              membantu siswa SMA/MA memahami konsep perpangkatan dan bentuk akar melalui eksplorasi mandiri, soal
              kontekstual, dan sistem gamifikasi yang menarik.</p>
          </div><!-- Features -->
          <div
            class="bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-xl p-6 border border-yellow-500/30 mb-6">
            <h4 class="text-xl md:text-2xl font-bold mb-4 text-yellow-300 flex items-center gap-2"><span>â­</span> Fitur
              Utama</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="flex items-start gap-3 bg-black/20 rounded-lg p-4"><span class="text-2xl">ğŸ®</span>
                <div>
                  <p class="font-semibold text-white mb-1">Gamifikasi</p>
                  <p class="text-sm text-gray-300">17 badges koleksi dan sistem skor</p>
                </div>
              </div>
              <div class="flex items-start gap-3 bg-black/20 rounded-lg p-4"><span class="text-2xl">ğŸ”¬</span>
                <div>
                  <p class="font-semibold text-white mb-1">Inkuiri</p>
                  <p class="text-sm text-gray-300">5 fase pembelajaran berbasis inkuiri</p>
                </div>
              </div>
              <div class="flex items-start gap-3 bg-black/20 rounded-lg p-4"><span class="text-2xl">ğŸ“Š</span>
                <div>
                  <p class="font-semibold text-white mb-1">Tracking Progress</p>
                  <p class="text-sm text-gray-300">Papan peringkat dan statistik pemain</p>
                </div>
              </div>
              <div class="flex items-start gap-3 bg-black/20 rounded-lg p-4"><span class="text-2xl">ğŸ§ª</span>
                <div>
                  <p class="font-semibold text-white mb-1">Eksplorasi Interaktif</p>
                  <p class="text-sm text-gray-300">Kalkulator eksponen untuk bereksperimen</p>
                </div>
              </div>
            </div>
          </div><!-- Technology Stack -->
          <div class="bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-xl p-6 border border-blue-500/30 mb-6">
            <h4 class="text-xl md:text-2xl font-bold mb-4 text-cyan-300 flex items-center gap-2"><span>ğŸ’»</span>
              Teknologi yang Digunakan</h4>
            <div class="flex flex-wrap gap-3"><span
                class="px-4 py-2 bg-black/30 rounded-full text-sm font-medium border border-cyan-500/30">HTML5</span>
              <span class="px-4 py-2 bg-black/30 rounded-full text-sm font-medium border border-cyan-500/30">CSS3</span>
              <span
                class="px-4 py-2 bg-black/30 rounded-full text-sm font-medium border border-cyan-500/30">JavaScript</span>
              <span class="px-4 py-2 bg-black/30 rounded-full text-sm font-medium border border-cyan-500/30">Tailwind
                CSS</span> <span
                class="px-4 py-2 bg-black/30 rounded-full text-sm font-medium border border-cyan-500/30">LocalStorage
                API</span>
            </div>
          </div>

          <!-- Storage Manager -->
          <div class="bg-gradient-to-r from-red-500/20 to-rose-500/20 rounded-xl p-6 border border-red-500/30 mb-6">
            <h4 class="text-xl md:text-2xl font-bold mb-4 text-red-300 flex items-center gap-2"><span>ğŸ“Š</span>
              Statistik Pemain </h4>

            <div class="space-y-4">
              <!-- Player Stats -->
              <div id="player-stats-display" class="bg-black/30 rounded-lg p-4">
                <p class="text-sm font-semibold text-gray-300 mb-3">Data Pemain Saya:</p>
                <div class="grid grid-cols-2 gap-3 text-sm">
                  <div>
                    <p class="text-gray-400 text-xs">Total Skor:</p>
                    <p class="font-bold text-cyan-400 text-lg" id="stat-total-score">0</p>
                  </div>
                  <div>
                    <p class="text-gray-400 text-xs">Game Dimainkan:</p>
                    <p class="font-bold text-green-400 text-lg" id="stat-games-played">0</p>
                  </div>
                  <div>
                    <p class="text-gray-400 text-xs">Jawaban Benar:</p>
                    <p class="font-bold text-emerald-400 text-lg" id="stat-correct-answers">0</p>
                  </div>
                  <div>
                    <p class="text-gray-400 text-xs">Jawaban Salah:</p>
                    <p class="font-bold text-red-400 text-lg" id="stat-wrong-answers">0</p>
                  </div>
                  <div class="col-span-2">
                    <p class="text-gray-400 text-xs">Rata-rata Skor:</p>
                    <p class="font-bold text-yellow-400 text-lg" id="stat-average-score">0</p>
                  </div>
                </div>
              </div>

              <!-- Actions -->
              <div class="grid grid-cols-2 gap-2">
                <button onclick="refreshCurrentPlayerStats()"
                  class="px-4 py-3 bg-purple-500/20 border border-purple-500/50 rounded-lg hover:bg-purple-500/30 transition-colors text-sm font-medium">
                  ğŸ”„ Refresh
                </button>
                <button onclick="resetPlayerStats()"
                  class="px-4 py-3 bg-red-500/20 border border-red-500/50 rounded-lg hover:bg-red-500/30 transition-colors text-sm font-medium">
                  ğŸ—‘ï¸ Reset Stat
                </button>
              </div>
            </div>
          </div>

          <!-- Thank You -->
          <div
            class="mt-6 text-center bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-xl p-6 border border-purple-500/20">
            <p class="text-lg md:text-xl font-semibold text-purple-300 mb-2">ğŸ’œ Terima Kasih</p>
            <p class="text-sm md:text-base text-gray-300">Media ini dibuat dengan penuh cinta dan diharapkan dapat
              bermanfaat untuk pembelajaran matematika yang lebih menyenangkan dan bermakna!</p>
          </div>
        </div>
      </section><!-- Game Screen -->
      <section id="game-section" class="hidden">
        <div class="card-glass rounded-2xl p-6 md:p-8"><!-- Game header -->
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-4"><button onclick="exitGame()"
                class="px-4 py-2 bg-red-500/20 border border-red-500/50 rounded-lg hover:bg-red-500/30 transition-colors">
                X Keluar </button>
              <div>
                <p class="text-sm text-gray-400">Level <span id="current-level-display">1</span></p>
                <p class="text-xl font-bold" id="level-title">Perpangkatan Dasar</p>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <div class="text-center">
                <p class="text-sm text-gray-400">Waktu</p>
                <p class="text-2xl font-bold" id="timer-display">5:00</p>
              </div>
              <div class="text-center">
                <p class="text-sm text-gray-400">Skor</p>
                <p class="text-2xl font-bold text-yellow-400" id="game-score">0</p>
              </div>
            </div>
          </div><!-- Progress -->
          <div class="mb-6">
            <div class="flex items-center justify-between mb-2">
              <p class="text-sm text-gray-400">Soal <span id="current-question-num">1</span> dari 10</p>
              <p class="text-sm text-gray-400">Benar: <span id="correct-count" class="text-green-400 font-bold">0</span>
                | Salah: <span id="wrong-count" class="text-red-400 font-bold">0</span></p>
            </div>
            <div class="h-3 bg-black/30 rounded-full overflow-hidden">
              <div id="question-progress" class="h-full bg-gradient-to-r from-indigo-500 to-purple-500 progress-bar"
                style="width: 10%"></div>
            </div>
          </div><!-- Question -->
          <div id="question-container" class="space-y-6"><!-- Orientation -->
            <div class="bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-xl p-6 border border-blue-500/30">
              <h4 class="font-bold text-lg mb-3 flex items-center gap-2 text-cyan-300"><span>ğŸ“‹</span> Orientasi Masalah
              </h4>
              <p class="text-base md:text-lg text-gray-200" id="orientation-text">Pahami konteks masalah ini dengan
                baik.</p>
            </div><!-- Question Text -->
            <div
              class="bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-xl p-6 md:p-8 border border-indigo-500/30">
              <p class="text-xl md:text-2xl font-bold mb-4 text-center" id="question-text">Memuat soal...</p>
            </div><!-- Hint Section -->
            <div
              class="bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-xl p-6 border border-yellow-500/30">
              <button onclick="toggleHint()" id="hint-button"
                class="w-full flex items-center justify-between font-bold text-lg text-yellow-300 mb-3"> <span>ğŸ’¡ Lihat
                  Hint</span> <span>â–¼</span> </button>
              <div id="hint-section" class="hidden">
                <p class="text-base md:text-lg text-gray-200" id="hint-text">Kerjakan soal sesuai dengan materi yang
                  telah dipelajari.</p>
              </div>
            </div><!-- Hypothesis Section -->
            <div class="bg-gradient-to-r from-green-500/20 to-emerald-500/20 rounded-xl p-6 border border-green-500/30">
              <h4 class="font-bold text-lg mb-3 flex items-center gap-2 text-green-300"><span>ğŸ’­</span> Rumuskan
                Hipotesis Jawabanmu</h4>
              <p class="text-sm md:text-base text-gray-300 mb-3">Sebelum memilih jawaban, tuliskan dugaan dan alasan
                kamu di bawah ini:</p><textarea id="hypothesis-input"
                placeholder="Contoh: Saya menduga jawabannya adalah... karena..."
                class="w-full bg-black/30 border border-white/20 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-green-500 min-h-[100px] mb-3"></textarea>
              <button id="save-hypothesis-btn" onclick="saveHypothesis()"
                class="w-full bg-gradient-to-r from-green-500 to-emerald-500 px-6 py-3 rounded-lg font-bold hover:opacity-90 transition-opacity">
                âœ“ Simpan Hipotesis &amp; Lanjutkan </button>
            </div><!-- Options Section (Hidden until hypothesis saved) -->
            <div id="options-section"
              class="hidden bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-xl p-6 border border-purple-500/30">
              <h4 class="font-bold text-lg mb-4 flex items-center gap-2 text-purple-300"><span>ğŸ¯</span> Pilih Jawaban
              </h4>
              <div id="options-container" class="space-y-3"><!-- Options rendered here -->
              </div>
            </div>
          </div><!-- Feedback -->
          <div id="feedback-container" class="hidden rounded-xl p-6 mb-6">
            <p class="text-xl font-bold mb-2" id="feedback-title"></p>
            <p class="text-gray-300" id="feedback-text"></p>
          </div>
        </div>
      </section>
    </main>
  </div>
  <audio id="click-sound" src="assets/sound/klik.mp3" preload="auto"></audio>
  <audio id="question-bgm" src="assets/sound/backsong_soal.m4a" preload="auto" loop></audio>
  <script>
    // ==================== Configuration ====================
    const defaultConfig = {
      app_title: 'XnRoot',
      welcome_title: 'Selamat Datang di XnRoot!',
      welcome_description: 'Petualangan matematika interaktif dengan pendekatan inkuiri. Pelajari perpangkatan dan bentuk akar sambil bermain!. Agar pengalaman belajarmu lebih maksimal, silakan baca terlebih dahulu Petunjuk Bermain pada menu Petunjuk ğŸ“– sebelum memulai'
    };

    // ==================== UI Sounds ====================
    const clickSound = document.getElementById('click-sound');
    const questionBgm = document.getElementById('question-bgm');

    function playClickSound() {
      if (!clickSound) {
        return;
      }
      try {
        clickSound.currentTime = 0;
        const playPromise = clickSound.play();
        if (playPromise && typeof playPromise.catch === 'function') {
          playPromise.catch(() => { });
        }
      } catch (error) {
        // Ignore autoplay or playback errors
      }
    }

    document.addEventListener('click', (event) => {
      const button = event.target.closest('button');
      if (!button || button.disabled) {
        return;
      }
      playClickSound();
    });

    function playQuestionBgm() {
      if (!questionBgm) {
        return;
      }
      try {
        if (!questionBgm.paused) {
          return;
        }
        const playPromise = questionBgm.play();
        if (playPromise && typeof playPromise.catch === 'function') {
          playPromise.catch(() => { });
        }
      } catch (error) {
        // Ignore autoplay or playback errors
      }
    }

    function stopQuestionBgm() {
      if (!questionBgm) {
        return;
      }
      questionBgm.pause();
      questionBgm.currentTime = 0;
    }

    // ==================== Badge Definitions ====================
    const badgeDefinitions = {
      explorer: { icon: 'ğŸ—ºï¸', name: 'Explorer', description: 'Mendaftar dan memulai petualangan', gradient: 'from-blue-500 to-cyan-500' },
      video_watcher: { icon: 'ğŸ“º', name: 'Video Watcher', description: 'Menonton video pembelajaran', gradient: 'from-red-500 to-pink-500' },
      material_reader: { icon: 'ğŸ“š', name: 'Material Reader', description: 'Membaca semua materi pembelajaran', gradient: 'from-indigo-500 to-purple-500' },
      experimenter: { icon: 'ğŸ§ª', name: 'Experimenter', description: 'Bereksperimen dengan kalkulator', gradient: 'from-green-500 to-emerald-500' },
      learner: { icon: 'ğŸ“', name: 'Learner', description: 'Menyelesaikan Level 1', gradient: 'from-green-500 to-teal-500' },
      thinker: { icon: 'ğŸ§ ', name: 'Thinker', description: 'Menyelesaikan Level 2', gradient: 'from-yellow-500 to-orange-500' },
      master: { icon: 'ğŸ‘‘', name: 'Master', description: 'Menyelesaikan Level 3', gradient: 'from-purple-500 to-pink-500' },
      perfectionist: { icon: 'ğŸ’¯', name: 'Perfectionist', description: 'Mendapat skor sempurna 1000', gradient: 'from-yellow-400 to-yellow-600' },
      champion: { icon: 'ğŸ†', name: 'Champion', description: 'Mendapat skor minimal 900', gradient: 'from-red-500 to-rose-500' },
      speedster: { icon: 'âš¡', name: 'Speedster', description: 'Menyelesaikan level cepat dan skor tinggi', gradient: 'from-cyan-400 to-blue-500' },
      comeback_kid: { icon: 'ğŸ”„', name: 'Comeback Kid', description: 'Mengulang level dan meningkatkan skor', gradient: 'from-orange-500 to-red-500' },
      three_star: { icon: 'â­', name: 'Three Star', description: 'Menyelesaikan semua 3 level', gradient: 'from-yellow-500 to-amber-500' },
      perfect_trilogy: { icon: 'ğŸ¯', name: 'Perfect Trilogy', description: 'Mendapat skor >= 800 di semua level', gradient: 'from-purple-600 to-pink-600' },
      inquiry_master: { icon: 'ğŸ”¬', name: 'Inquiry Master', description: 'Membaca semua fase inkuiri', gradient: 'from-teal-500 to-cyan-500' },
      persistent: { icon: 'ğŸ’ª', name: 'Persistent', description: 'Menjawab 50 soal', gradient: 'from-gray-600 to-gray-800' },
      accurate: { icon: 'ğŸ¯', name: 'Accurate', description: 'Menjawab 10 soal berturut-turut benar', gradient: 'from-lime-500 to-green-500' },
      scholar: { icon: 'ğŸ“–', name: 'Scholar', description: 'Membaca CP/TP', gradient: 'from-indigo-600 to-blue-600' }
    };

    // ==================== Learning Materials ====================
    const videos = {
      dasar: `
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="bg-black/30 rounded-xl overflow-hidden cursor-pointer" onclick="trackVideoWatch()">
            <div class="video-container"><iframe src="https://www.youtube.com/embed/EOR0-MBaIz4"
                title="Bilangan Berpangkat | Matematika SMP" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
            </div>
            <div class="p-4">
              <h5 class="font-bold text-xl md:text-2xl text-indigo-300">Konsep Perpangkatan</h5>
              <p class="text-base md:text-lg text-gray-400 mt-1">Konsep dasar bilangan berpangkat untuk SMP</p>
            </div>
          </div>
          <div class="bg-black/30 rounded-xl overflow-hidden cursor-pointer" onclick="trackVideoWatch()">
            <div class="video-container"><iframe src="https://www.youtube.com/embed/X48F-IM_GF8"
                title="Bentuk Akar (1) - Bentuk Kuadrat dan Cara Menyederhanakan Akar - Matematika SMP" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
            </div>
            <div class="p-4">
              <h5 class="font-bold text-xl md:text-2xl text-green-300">Bentuk Akar</h5>
              <p class="text-base md:text-lg text-gray-400 mt-1">Bentuk akar dan cara menyederhanakannya</p>
            </div>
          </div>
        </div>
      `,
      nol: `
        <div class="grid grid-cols-1 gap-6">
          <div class="bg-black/30 rounded-xl overflow-hidden cursor-pointer" onclick="trackVideoWatch()">
            <div class="video-container"><iframe src="https://www.youtube.com/embed/IPejnJDcQdM"
                title="Perpangkatan dan Bentuk Akar [Part 4] - Pangkat 0 & Negatif" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
            </div>
            <div class="p-4">
              <h5 class="font-bold text-xl md:text-2xl text-purple-300">Pangkat Nol & Negatif</h5>
              <p class="text-base md:text-lg text-gray-400 mt-1">Pangkat 0 dan negatif untuk SMP</p>
            </div>
          </div>
        </div>
      `,
      pecahan: `
        <div class="grid grid-cols-1 gap-6">
          <div class="bg-black/30 rounded-xl overflow-hidden cursor-pointer" onclick="trackVideoWatch()">
            <div class="video-container"><iframe src="https://www.youtube.com/embed/kXC2TR2Cwhg"
                title="PANGKAT PECAHAN DAN BENTUK AKAR" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
            </div>
            <div class="p-4">
              <h5 class="font-bold text-xl md:text-2xl text-emerald-300">Pangkat Pecahan & Bentuk Akar</h5>
              <p class="text-base md:text-lg text-gray-400 mt-1">Pangkat pecahan dan bentuk akar untuk SMP</p>
            </div>
          </div>
        </div>
      `
    };

    const materials = {
      dasar: `
        <h4 class="text-2xl md:text-3xl font-bold mb-6 text-green-300">ğŸ“š Perpangkatan Dasar</h4>
        <div class="space-y-5 text-gray-300">
          
          <!-- Fase 1: Orientasi Masalah -->
          <div class="bg-blue-500/10 p-5 rounded-lg border border-blue-500/30">
            <p class="font-bold text-lg text-cyan-300 mb-3 flex items-center gap-2">
              <span>1ï¸âƒ£</span> Orientasi dan Merumuskan Masalah
            </p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <p class="text-base md:text-lg font-semibold text-cyan-200 mb-2">ğŸ“± Kasus: Viral di Media Sosial</p>
              <p class="text-base md:text-lg mb-2">Kamu membuat video lucu dan membagikannya ke 3 teman. Setiap temanmu juga membagikannya ke 3 teman mereka masing-masing.</p>
              <p class="text-base md:text-lg mb-2">â€¢ Putaran 1: 3 orang menonton</p>
              <p class="text-base md:text-lg mb-2">â€¢ Putaran 2: 3 Ã— 3 = 9 orang menonton</p>
              <p class="text-base md:text-lg">â€¢ Putaran 3: 9 Ã— 3 = 27 orang menonton</p>
            </div>
            <p class="text-base md:text-lg font-semibold text-yellow-300">â“ Berapa orang yang menonton setelah 5 putaran? Bagaimana cara menghitungnya dengan efisien?</p>
            <p class="text-sm md:text-base text-gray-400 mt-2 italic">ğŸ’­ Pikirkan: Apakah ada pola matematika di sini?</p>
          </div>
          
          <!-- Fase 2: Merumuskan Hipotesis -->
          <div class="bg-green-500/10 p-5 rounded-lg border border-green-500/30">
            <p class="font-bold text-lg text-green-300 mb-3 flex items-center gap-2">
              <span>2ï¸âƒ£</span> Merumuskan Hipotesis
            </p>
            <p class="text-base md:text-lg mb-3">ğŸ” Mari amati pola penyebarannya:</p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <ul class="space-y-2 text-base md:text-lg">
                <li>â€¢ Putaran 1: 3 = 3Â¹</li>
                <li>â€¢ Putaran 2: 3 Ã— 3 = 3Â²</li>
                <li>â€¢ Putaran 3: 3 Ã— 3 Ã— 3 = 3Â³</li>
                <li>â€¢ Putaran 4: 3 Ã— 3 Ã— 3 Ã— 3 = 3â´</li>
              </ul>
            </div>
            <p class="text-base md:text-lg font-semibold text-green-300 mb-2">ğŸ’¡ Hipotesis:</p>
            <p class="text-base md:text-lg">"Jumlah penonton pada putaran ke-n adalah 3<sup>n</sup>, artinya 3 dikalikan dengan dirinya sendiri sebanyak n kali. Ini disebut <strong>perpangkatan</strong>!"</p>
          </div>
          
          <!-- Fase 3: Mengumpulkan Data -->
          <div class="bg-yellow-500/10 p-5 rounded-lg border border-yellow-500/30">
            <p class="font-bold text-lg text-yellow-300 mb-3 flex items-center gap-2">
              <span>3ï¸âƒ£</span> Mengumpulkan Data
            </p>
            <p class="text-base md:text-lg mb-3">ğŸ”¬ <strong>Eksperimen:</strong> Gunakan kalkulator eksplorasi di bawah untuk menguji hipotesis!</p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <p class="text-base md:text-lg mb-2"><strong>Coba hitung:</strong></p>
              <ul class="list-disc list-inside space-y-1 ml-4 text-base md:text-lg">
                <li>3âµ (untuk 5 putaran) = ?</li>
                <li>2â´ (jika membagikan ke 2 orang, 4 putaran) = ?</li>
                <li>5Â³ (jika membagikan ke 5 orang, 3 putaran) = ?</li>
              </ul>
            </div>
            <p class="text-base md:text-lg italic text-gray-400">ğŸ’¡ Tip: Bandingkan hasil eksperimen dengan hipotesismu!</p>
          </div>
          
          <!-- Fase 4: Menguji Hipotesis -->
          <div class="bg-purple-500/10 p-5 rounded-lg border border-purple-500/30">
            <p class="font-bold text-lg text-purple-300 mb-3 flex items-center gap-2">
              <span>4ï¸âƒ£</span> Menguji Hipotesis
            </p>
            <p class="text-base md:text-lg mb-3">âœ“ <strong>Hasil Pengujian:</strong></p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <p class="text-base md:text-lg mb-2">Untuk video viral (basis 3):</p>
              <ul class="space-y-2 ml-4 text-base md:text-lg">
                <li>âœ“ 3âµ = 243 penonton âœ“</li>
                <li>âœ“ 3â¶ = 729 penonton âœ“</li>
                <li>âœ“ 3â· = 2,187 penonton âœ“</li>
              </ul>
            </div>
            <p class="text-base md:text-lg font-semibold text-purple-300">âœ… Hipotesis terbukti benar! Pola perpangkatan berlaku untuk pertumbuhan viral!</p>
          </div>
          
          <!-- Fase 5: Kesimpulan -->
          <div class="bg-red-500/10 p-5 rounded-lg border border-red-500/30">
            <p class="font-bold text-lg text-red-300 mb-3 flex items-center gap-2">
              <span>5ï¸âƒ£</span> Merumuskan Kesimpulan
            </p>
            <div class="bg-black/30 p-4 rounded-lg mb-4">
              <p class="font-bold mb-2 text-lg">ğŸ“– Definisi Perpangkatan:</p>
              <p class="text-lg md:text-xl mb-2">a<sup>n</sup> = a Ã— a Ã— a Ã— ... Ã— a (sebanyak n kali)</p>
              <p class="text-base md:text-lg text-gray-300">â€¢ a = <strong>basis</strong> (bilangan yang dikalikan berulang)</p>
              <p class="text-base md:text-lg text-gray-300">â€¢ n = <strong>pangkat/eksponen</strong> (banyaknya perkalian)</p>
            </div>
            <div class="bg-black/30 p-4 rounded-lg">
              <p class="text-base md:text-lg font-bold mb-3">ğŸŒŸ Aplikasi Nyata Perpangkatan:</p>
              <ul class="space-y-3 text-base md:text-lg">
                <li><strong>ğŸ“± Media Sosial:</strong> Konten viral menyebar secara eksponensial (3<sup>n</sup>, 2<sup>n</sup>)</li>
                <li><strong>ğŸ’° Investasi:</strong> Bunga majemuk di bank: Modal Ã— (1.05)<sup>tahun</sup></li>
                <li><strong>ğŸ’¾ Kapasitas Data:</strong> 2GB, 4GB, 8GB, 16GB = 2Â¹, 2Â², 2Â³, 2â´</li>
                <li><strong>ğŸ¦  Pertumbuhan Bakteri:</strong> Pembelahan sel: 2<sup>n</sup> sel</li>
                <li><strong>ğŸ“ˆ Pertumbuhan Ekonomi:</strong> Populasi, GDP meningkat eksponensial</li>
                <li><strong>ğŸ® Skor Game:</strong> Combo multiplier: skor Ã— 2<sup>combo</sup></li>
              </ul>
            </div>
          </div>
        </div>
      `,
      nol: `
        <h4 class="text-2xl md:text-3xl font-bold mb-6 text-yellow-300">? Pangkat Nol dan Negatif</h4>
        <div class="space-y-5 text-gray-300">
          
          <!-- Fase 1: Orientasi Masalah -->
          <div class="bg-blue-500/10 p-5 rounded-lg border border-blue-500/30">
            <p class="font-bold text-lg text-cyan-300 mb-3 flex items-center gap-2">
              <span>1ï¸âƒ£</span> Orientasi dan Merumuskan Masalah
            </p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <p class="text-base md:text-lg font-semibold text-cyan-200 mb-2">ğŸ”‹ Kasus: Pembagian Baterai HP</p>
              <p class="text-base md:text-lg mb-2">Baterai HP kamu penuh 100%. Setiap jam, daya berkurang menjadi setengahnya karena main game:</p>
              <p class="text-base md:text-lg mb-2">â€¢ Jam ke-3: 100% Ã· 2Â³ = 100% Ã· 8 = 12.5%</p>
              <p class="text-base md:text-lg mb-2">â€¢ Jam ke-2: 100% Ã· 2Â² = 100% Ã· 4 = 25%</p>
              <p class="text-base md:text-lg">â€¢ Jam ke-1: 100% Ã· 2Â¹ = 100% Ã· 2 = 50%</p>
            </div>
            <p class="text-base md:text-lg font-semibold text-yellow-300">â“ Berapa persen baterai di jam ke-0 (saat penuh)? Bagaimana dengan 1 jam SEBELUM diisi (jam ke -1)?</p>
            <p class="text-sm md:text-base text-gray-400 mt-2 italic">ğŸ’­ Pikirkan: Apa arti 2â° dan 2â»Â¹?</p>
          </div>
          
          <!-- Fase 2: Merumuskan Hipotesis -->
          <div class="bg-green-500/10 p-5 rounded-lg border border-green-500/30">
            <p class="font-bold text-lg text-green-300 mb-3 flex items-center gap-2">
              <span>2ï¸âƒ£</span> Merumuskan Hipotesis
            </p>
            <p class="text-base md:text-lg mb-3">ğŸ” Mari amati pola penurunan daya baterai:</p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <ul class="space-y-2 text-base md:text-lg">
                <li>â€¢ 2Â³ = 8 (jam ke-3)</li>
                <li>â€¢ 2Â² = 4 (jam ke-2, dibagi 2)</li>
                <li>â€¢ 2Â¹ = 2 (jam ke-1, dibagi 2 lagi)</li>
                <li>â€¢ Ã— = ? (jam ke-0, mungkin dibagi 2 lagi = 1?)</li>
                <li>â€¢ 2â»Â¹ = ? (1 jam sebelum isi, mungkin <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">2</span></span>?)</li>
              </ul>
            </div>
            <p class="text-base md:text-lg font-semibold text-green-300 mb-2">ğŸ’¡ Hipotesis:</p>
            <p class="text-base md:text-lg">"Setiap pangkat turun 1, hasilnya dibagi basis. Maka Ã— = 1 dan 2â»Â¹ = <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">2</span></span>!"</p>
          </div>
          
          <!-- Fase 3: Mengumpulkan Data -->
          <div class="bg-yellow-500/10 p-5 rounded-lg border border-yellow-500/30">
            <p class="font-bold text-lg text-yellow-300 mb-3 flex items-center gap-2">
              <span>3ğŸ”¬</span> Mengumpulkan Data
            </p>
            <p class="text-base md:text-lg mb-3">ğŸ§ª <strong>Eksperimen:</strong> Coba dengan basis berbeda di kalkulator eksplorasi!</p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <p class="text-base md:text-lg mb-2"><strong>Test Pangkat Nol:</strong></p>
              <ul class="list-disc list-inside space-y-1 ml-4 text-base md:text-lg">
                <li>3â° = ?</li>
                <li>5â° = ?</li>
                <li>10â° = ?</li>
              </ul>
              <p class="text-base md:text-lg mb-2 mt-3"><strong>Test Pangkat Negatif:</strong></p>
              <ul class="list-disc list-inside space-y-1 ml-4 text-base md:text-lg">
                <li>2â»Â¹ = ? (setengah dari 2â°)</li>
                <li>2â»Â² = ? (setengah dari 2â»Â¹)</li>
                <li>3â»Â¹ = ?</li>
              </ul>
            </div>
          </div>
          
          <!-- Fase 4: Menguji Hipotesis -->
          <div class="bg-purple-500/10 p-5 rounded-lg border border-purple-500/30">
            <p class="font-bold text-lg text-purple-300 mb-3 flex items-center gap-2">
              <span>4âœ…</span> Menguji Hipotesis
            </p>
            <p class="text-base md:text-lg mb-3">ğŸ“Š <strong>Hasil Pengujian:</strong></p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <p class="text-base md:text-lg mb-2"><strong>Pangkat Nol:</strong></p>
              <ul class="space-y-2 ml-4">
                <li>âœ“ 2â° = 1 (100% baterai = 1 Ã— 100%) âœ…</li>
                <li>âœ“ 3â° = 1</li>
                <li>âœ“ 10â° = 1</li>
                <li>âœ“ <strong>Semua bilangan pangkat 0 = 1!</strong></li>
              </ul>
            </div>
            <div class="bg-black/20 p-4 rounded-lg">
              <p class="text-base md:text-lg mb-2"><strong>Pangkat Negatif:</strong></p>
              <ul class="space-y-2 ml-4">
                <li>âœ“ 2â»Â¹ = <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">2</span></span> = 0.5 âœ…</li>
                <li>âœ“ Ã— = <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">4</span></span> = 0.25 âœ…</li>
                <li>âœ“ 2â»Â³ = <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">8</span></span> = 0.125 âœ…</li>
              </ul>
            </div>
            <p class="text-base md:text-lg font-semibold text-purple-300 mt-3">âœ… Hipotesis terbukti benar!</p>
          </div>
          
          <!-- Fase 5: Kesimpulan -->
          <div class="bg-red-500/10 p-5 rounded-lg border border-red-500/30">
            <p class="font-bold text-lg text-red-300 mb-3 flex items-center gap-2">
              <span>5ğŸ“‹</span> Merumuskan Kesimpulan
            </p>
            <div class="bg-black/30 p-4 rounded-lg mb-3">
              <p class="font-bold mb-2">ğŸ“ Kesimpulan Pangkat Nol:</p>
              <p class="text-lg md:text-xl mb-2">a<sup>0</sup> = 1(untuk a ? 0)</p>
              <p class="text-base text-gray-300">Bilangan apapun pangkat 0 = 1</p>
            </div>
            <div class="bg-black/30 p-4 rounded-lg mb-4">
              <p class="font-bold mb-2">ğŸ“ Kesimpulan Pangkat Negatif:</p>
              <p class="text-lg md:text-xl mb-2">a<sup>-n</sup> = <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">a<sup>n</sup></span></span></p>
              <p class="text-base text-gray-300">Pangkat negatif = kebalikan dari pangkat positif</p>
            </div>
            <div class="bg-black/30 p-4 rounded-lg">
              <p class="text-base md:text-lg font-bold mb-3">ğŸŒ Aplikasi Nyata:</p>
              <ul class="space-y-3 text-base md:text-lg">
                <li><strong>ğŸ”¬ Sains:</strong> Ukuran mikroskopis: 10â»â¶ m = 1 mikrometer (bakteri)</li>
                <li><strong>âš¡ Fisika:</strong> Konduktansi listrik (Î©â»Â¹), percepatan (m/sÂ² = mÂ·sâ»Â²)</li>
                <li><strong>ğŸ’Š Medis:</strong> Dosis obat: 10â»Â³ g = 1 miligram</li>
                <li><strong>ğŸ’» Teknologi:</strong> Ukuran chip: 5 nanometer = 5Ã—10â»â¹ meter</li>
                <li><strong>ğŸ’° Ekonomi:</strong> Inflasi negatif (deflasi), pertumbuhan negatif</li>
                <li><strong>ğŸŒ¡ï¸ Suhu:</strong> Skala logaritmik untuk pH, desibel (dB)</li>
              </ul>
            </div>
          </div>
        </div>
      `,
      pecahan: `
        <h4 class="text-2xl md:text-3xl font-bold mb-6 text-purple-300">ğŸ“ Pangkat Pecahan dan Bentuk Akar</h4>
        <div class="space-y-5 text-gray-300">
          
          <!-- Fase 1: Orientasi Masalah -->
          <div class="bg-blue-500/10 p-5 rounded-lg border border-blue-500/30">
            <p class="font-bold text-lg text-cyan-300 mb-3 flex items-center gap-2">
              <span>1ğŸ¯</span> Orientasi dan Merumuskan Masalah
            </p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <p class="text-base md:text-lg font-semibold text-cyan-200 mb-2">ğŸ“¦ Kasus: Menghitung Sisi Kotak</p>
              <p class="text-base md:text-lg mb-2">Kamu punya kotak kubik dengan volume 27 liter. Berapa panjang sisi kotak tersebut?</p>
              <p class="text-base md:text-lg mb-2">ğŸ“¦ Volume kubus = sisiÂ³</p>
              <p class="text-base md:text-lg">ğŸ“Œ Jadi: sisiÂ³ = 27</p>
              <p class="text-base md:text-lg mt-2">Kita tahu sisi = Â³âˆš27 = 3 (karena 3Â³ = 27)</p>
            </div>
            <p class="text-base md:text-lg font-semibold text-yellow-300">â“ Bagaimana dengan 27<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup>? Apakah sama dengan Â³âˆš27? Apa hubungan pangkat pecahan dengan akar?</p>
            <p class="text-sm md:text-base text-gray-400 mt-2 italic">ğŸ’¡ Pikirkan: Mungkinkah ada pola matematika di sini?</p>
          </div>
          
          <!-- Fase 2: Merumuskan Hipotesis -->
          <div class="bg-green-500/10 p-5 rounded-lg border border-green-500/30">
            <p class="font-bold text-lg text-green-300 mb-3 flex items-center gap-2">
              <span>2ğŸ’¡</span> Merumuskan Hipotesis
            </p>
            <p class="text-base md:text-lg mb-3">ğŸ’­ Mari berpikir tentang hubungannya:</p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <ul class="space-y-2 text-base md:text-lg">
                <li>ğŸ“Œ Â³âˆš27 adalah bilangan yang jika dipangkatkan 3 = 27</li>
                <li>ğŸ“Œ Jika 27<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup> Ã— 27<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup> Ã— 27<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup> = 27<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span> + <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span> + <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup> = 27Â¹ = 27</li>
                <li>ğŸ“Œ Berarti 27<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup> adalah bilangan yang dipangkatkan 3 = 27</li>
              </ul>
            </div>
            <p class="text-base md:text-lg font-semibold text-green-300 mb-2">ğŸ¯ Hipotesis:</p>
            <p class="text-base md:text-lg">"Mungkin a<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">n</span></span></sup> = <sup>n</sup>âˆša! Pangkat pecahan <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">n</span></span> sama dengan akar pangkat n!"</p>
          </div>
          
          <!-- Fase 3: Mengumpulkan Data -->
          <div class="bg-yellow-500/10 p-5 rounded-lg border border-yellow-500/30">
            <p class="font-bold text-lg text-yellow-300 mb-3 flex items-center gap-2">
              <span>3ğŸ”¬</span> Mengumpuylkan Data
            </p>
            <p class="text-base md:text-lg mb-3">ğŸ§ª <strong>Eksperimen:</strong> Coba dengan kalkulator eksplorasi!</p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <p class="text-base md:text-lg mb-2"><strong>Coba hitung:</strong></p>
              <ul class="list-disc list-inside space-y-1 ml-4 text-base md:text-lg">
                <li>16<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">2</span></span></sup> = ? (bandingkan dengan âˆš16)</li>
                <li>16<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">4</span></span></sup> = ? (bandingkan dengan â´âˆš16)</li>
                <li>8<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup> = ? (bandingkan dengan Â³âˆš8)</li>
                <li>4<sup class="sup-frac"><span class="frac"><span class="num">3</span><span class="bar"></span><span class="den">2</span></span></sup> = ? (coba âˆš(4Â³) atau (âˆš4)Â³)</li>
              </ul>
            </div>
            <p class="text-base md:text-lg italic text-gray-400">ğŸ’¡ Tip: Perhatikan apakah hasilnya sama dengan operasi akar!</p>
          </div>
          
          <!-- Fase 4: Menguji Hipotesis -->
          <div class="bg-purple-500/10 p-5 rounded-lg border border-purple-500/30">
            <p class="font-bold text-lg text-purple-300 mb-3 flex items-center gap-2">
              <span>4âœ…</span> Menguji Hipotesis
            </p>
            <p class="text-base md:text-lg mb-3">ğŸ“Š <strong>Hasil Pengujian:</strong></p>
            <div class="bg-black/20 p-4 rounded-lg mb-3">
              <ul class="space-y-2 ml-4 text-base md:text-lg">
                <li>âœ“ 16<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">2</span></span></sup> = 4 = âˆš16 âœ…</li>
                <li>âœ“ 16<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">4</span></span></sup> = 2 = â´âˆš16 âœ…</li>
                <li>âœ“ 8<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span></sup> = 2 = Â³âˆš8 âœ…</li>
                <li>âœ“ 4<sup class="sup-frac"><span class="frac"><span class="num">3</span><span class="bar"></span><span class="den">2</span></span></sup> = (âˆš4)Â³ = 2Â³ = 8 âœ…</li>
              </ul>
            </div>
            <p class="text-base md:text-lg font-semibold text-purple-300">âœ… Hipotesis terbukti! Ada hubungan pasti antara pangkat pecahan dan akar!</p>
          </div>
          
          <!-- Fase 5: Kesimpulan -->
          <div class="bg-red-500/10 p-5 rounded-lg border border-red-500/30">
            <p class="font-bold text-lg text-red-300 mb-3 flex items-center gap-2">
              <span>5ğŸ“‹</span> Merumuskan Kesimpulan
            </p>
            <div class="bg-black/30 p-4 rounded-lg mb-3">
              <p class="font-bold mb-2">ğŸ“ Kesimpulan 1:</p>
              <p class="text-lg md:text-xl mb-2">a<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">n</span></span></sup> = <sup>n</sup>âˆša</p>
              <p class="text-base text-gray-300">Pangkat <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">n</span></span> sama dengan akar pangkat n</p>
            </div>
            <div class="bg-black/30 p-4 rounded-lg mb-4">
              <p class="font-bold mb-2">ğŸ“ Kesimpulan 2:</p>
              <p class="text-lg md:text-xl mb-2">a<sup class="sup-frac"><span class="frac"><span class="num">m</span><span class="bar"></span><span class="den">n</span></span></sup> = <sup>n</sup>âˆš(a<sup>m</sup>) = (<sup>n</sup>âˆša)<sup>m</sup></p>
              <p class="text-base text-gray-300">Untuk pangkat pecahan umum <span class="frac"><span class="num">m</span><span class="bar"></span><span class="den">n</span></span></p>
            </div>
            <div class="bg-black/30 p-4 rounded-lg">
              <p class="text-base md:text-lg font-bold mb-3">ğŸŒ Aplikasi Nyata:</p>
              <ul class="space-y-3 text-base md:text-lg">
                <li><strong>ğŸ—ï¸ Arsitektur:</strong> Menghitung dimensi ruangan dari volume/luas</li>
                <li><strong>ğŸ“ Geometri:</strong> Diagonal persegi = sisi Ã— âˆš2</li>
                <li><strong>ğŸµ Musik:</strong> Interval nada: 2<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">12</span></span></sup>, 2<sup class="sup-frac"><span class="frac"><span class="num">2</span><span class="bar"></span><span class="den">12</span></span></sup>, dst.</li>
                <li><strong>âš¡ Fisika:</strong> Kecepatan gelombang = âˆš(tegangan/massa)</li>
                <li><strong>ğŸ“Š Statistik:</strong> Standar deviasi = âˆš(varians)</li>
                <li><strong>ğŸ’° Keuangan:</strong> Rata-rata geometrik: (aÃ—b)<sup class="sup-frac"><span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">2</span></span></sup></li>
              </ul>
            </div>
          </div>
        </div>
      `
    };

    // ==================== Question Bank ====================
    const questionBank = {
      1: [
        { q: "Adi memiliki 4 kotak pensil. Setiap kotak berisi 4 pensil yang sama. Bentuk perpangkatan dari jumlah pensil tersebut adalah â€¦", options: ["4 + 4", "4Â²", "3 Ã— 4", "4Â³"], correct: 1, hint: "Perhatikan perkalian berulang dari isi setiap kotak.", explanation: "4 kotak masing-masing 4 pensil â†’ 4 Ã— 4 = 4Â²" },
        { q: "Sebuah lampu menyala 2 kali lebih terang setiap jam. Setelah 3 jam, faktor peningkatan terang lampu dapat ditulis sebagai â€¦", options: ["2 + 3", "2 Ã— 3", "2Â³", "3Â²"], correct: 2, hint: "â€œDua kali setiap jamâ€ menunjukkan perkalian berulang.", explanation: "2 Ã— 2 Ã— 2 = 2Â³" },
        { q: "Ada 4 siswa yang berlari di lapangan dan setiap siswa berlari 5 lap. Bentuk yang sesuai adalah â€¦", options: ["5Â²", "4Â²", "5 Ã— 4", "4Â³"], correct: 2, hint: "Hitung total lap terlebih dahulu.", explanation: "4 Ã— 5" },
        { q: "Paman memiliki 3 jenis ikan, setiap jenis ada 3 ekor. Bentuk yang tepat adalah â€¦", options: ["3 + 3", "9", "3Â²", "3Â³"], correct: 2, hint: "Bilangan dikalikan dengan dirinya sendiri.", explanation: "3 Ã— 3 = 3Â²" },
        { q: "Pola bilangan 2, 4, 8, 16, â€¦ Bilangan ke-5 adalah â€¦", options: ["18", "24", "32", "64"], correct: 2, hint: "Setiap bilangan dikali 2.", explanation: "2, 4, 8, 16, 32" },
        { q: "Nilai dari 2Â³ Ã— 2Â² adalah â€¦", options: ["2âµ", "32", "16", "8"], correct: 1, hint: "Jika basis sama, pangkat dijumlahkan.", explanation: "2Â³ Ã— 2Â² = 2âµ = 32" },
        { q: "Di kebun terdapat 3 baris tanaman, setiap baris berisi 3 tanaman. Jumlah tanaman adalah â€¦", options: ["6", "9", "12", "27"], correct: 1, hint: "Baris Ã— isi per baris.", explanation: "3 Ã— 3 = 9" },
        { q: "Sebuah rak berisi 2 buku di setiap tumpuk dan ada 7 tumpuk. Bentuk matematisnya adalah â€¦", options: ["2â·", "7Â²", "7 Ã— 2", "7 + 2"], correct: 2, hint: "Total = jumlah tumpuk Ã— isi per tumpuk.", explanation: "7 Ã— 2" },
        { q: "Dalam lomba estafet digital, jumlah pesan selalu menjadi dua kali lipat setiap tahap. Jika tahap berlangsung 5 kali, model matematika yang tepat adalah â€¦", options: ["5Â²", "2 + 5", "2âµ", "2 Ã— 5"], correct: 2, hint: "â€œDua kali lipatâ€ berulang 5 tahap.", explanation: "2 Ã— 2 Ã— 2 Ã— 2 Ã— 2 = 2âµ" },
        { q: "Nilai dari 2â´ adalah â€¦", options: ["6", "8", "16", "32"], correct: 2, hint: "Perkalian berulang 2 sebanyak 4 kali.", explanation: "2â´ = 2 Ã— 2 Ã— 2 Ã— 2 = 16" }
      ],
      2: [
        { q: "Nilai dari 5â° adalah â€¦", options: ["0", "1", "5", "10"], correct: 1, hint: "Bilangan (selain 0) pangkat 0 hasilnya 1.", explanation: "5â° = 1" },
        { q: "Jika tidak ada pengulangan perkalian, pangkat yang digunakan adalah â€¦", options: ["satu", "dua", "nol", "negatif"], correct: 2, hint: "Ingat aturan pangkat 0.", explanation: "Tidak ada pengulangan perkalian â†’ pangkat 0" },
        { q: "Kondisi tidak melakukan pengulangan dapat dimodelkan dengan 8â°. Nilainya adalah â€¦", options: ["0", "1", "8", "64"], correct: 1, hint: "Pangkat 0 bernilai 1.", explanation: "8â° = 1" },
        { q: "Satu pizza dibagi rata untuk 4 anak. Bagian setiap anak dapat ditulis sebagai â€¦", options: ["4", "4â»Â¹", "4Â²", "4Â³"], correct: 1, hint: "Pembagian sama rata = kebalikan.", explanation: "1/4 = 4â»Â¹" },
        { q: "Jika sebuah cokelat dibagi rata kepada 2 orang, bagian setiap orang adalah â€¦", options: ["2", "2â»Â¹", "2Â²", "2Â³"], correct: 1, hint: "Bagi 2 berarti 1/2.", explanation: "1/2 = 2â»Â¹" },
        { q: "Pernyataan perpangkatan negatif yang benar adalah â€¦", options: ["5â»Â¹ = 5", "5â»Â¹ = 1/5", "5â»Â¹ = âˆ’5", "5â»Â¹ = 0"], correct: 1, hint: "Pangkat negatif = kebalikan.", explanation: "5â»Â¹ = 1/5" },
        { q: "Jika suatu nilai tidak mengalami pertumbuhan, faktor perpangkatannya adalah â€¦", options: ["0", "1", "âˆ’1", "bilangan negatif"], correct: 1, hint: "Tidak berubah â†’ dikali 1.", explanation: "Faktor pertumbuhan 1" },
        { q: "Nilai dari 3â»Â² adalah â€¦", options: ["9", "6", "1/9", "3"], correct: 2, hint: "Gunakan kebalikan dari 3Â².", explanation: "3â»Â² = 1/3Â² = 1/9" },
        { q: "Seorang siswa membagi 1 liter air ke dalam 8 botol sama besar. Banyak air di setiap botol dinyatakan sebagai â€¦", options: ["8 liter", "1/8 liter", "8â»Â¹ liter", "1 liter"], correct: 1, hint: "Satu liter dibagi 8 bagian.", explanation: "1/8 liter" },
        { q: "Nilai dari 3Â² Ã— 3â»Â² adalah â€¦", options: ["0", "1", "6", "36"], correct: 1, hint: "Jika basis sama, pangkat dijumlahkan.", explanation: "3Â² Ã— 3â»Â² = 3â° = 1" }
      ],
      3: [
        { q: "Pak Budi menyusun 25 ubin berbentuk persegi. Banyak ubin di setiap sisi adalah â€¦", options: ["3", "4", "5", "10"], correct: 2, hint: "Cari akar kuadrat dari 25.", explanation: "âˆš25 = 5" },
        { q: "Banyak baris untuk menyusun 16 buku dengan 4 buku tiap baris adalah â€¦", options: ["2", "3", "4", "8"], correct: 2, hint: "Jumlah baris = total Ã· isi per baris.", explanation: "16 Ã· 4 = 4" },
        { q: "Bentuk lain dari 16^(1/2) adalah â€¦", options: ["16Â²", "2â´", "âˆš16", "4Â²"], correct: 2, hint: "Pangkat 1/2 sama dengan akar kuadrat.", explanation: "16^(1/2) = âˆš16" },
        { q: "Nilai dari âˆš36 adalah â€¦", options: ["3", "6", "9", "12"], correct: 1, hint: "Bilangan yang kuadratnya 36.", explanation: "âˆš36 = 6" },
        { q: "Nilai dari (âˆš9)Â³ adalah â€¦", options: ["9", "18", "27", "81"], correct: 2, hint: "Hitung akar dulu, lalu pangkat 3.", explanation: "âˆš9 = 3, lalu 3Â³ = 27" },
        { q: "Bentuk lain dari 8^(2/3) adalah â€¦", options: ["âˆš8Â²", "Â³âˆš8Â²", "(Â³âˆš8)Â²", "8Â³"], correct: 2, hint: "Pangkat m/n = (akar pangkat n)^m.", explanation: "8^(2/3) = (Â³âˆš8)Â²" },
        { q: "Nilai dari Â³âˆš27 adalah â€¦", options: ["2", "3", "6", "9"], correct: 1, hint: "Bilangan yang dipangkatkan 3 menghasilkan 27.", explanation: "Â³âˆš27 = 3" },
        { q: "Bentuk lain dari 25^(1/2) adalah â€¦", options: ["25Â²", "2âˆš5", "âˆš25", "5Â²"], correct: 2, hint: "Pangkat 1/2 sama dengan akar kuadrat.", explanation: "25^(1/2) = âˆš25" },
        { q: "Jika xÂ² = 49, maka nilai x adalah â€¦", options: ["5", "7", "6", "14"], correct: 1, hint: "Cari akar kuadrat dari 49.", explanation: "x = 7" },
        { q: "Nilai dari 12^1 adalah â€¦", options: ["1", "6", "12", "36"], correct: 2, hint: "Pangkat 1 sama dengan bilangan itu sendiri.", explanation: "12^1 = 12" }
      ]
    };

    // ==================== Global Variables ====================
    // CATATAN: Konfigurasi Supabase ada di assets/js/supabase-service.js
    // Edit SUPABASE_CONFIG di file tersebut (baris ~18)

    // Debug mode - set true untuk melihat detail log
    window.DEBUG_MODE = false; // Set true jika perlu debug

    // Helper function to get active storage service (Supabase with offline fallback)
    function getStorage() {
      return window.hybridStorageManager;
    }

    let currentPlayer = null;
    let allPlayers = [];
    let currentLevel = 1;
    let currentQuestionIndex = 0;
    let levelScore = 0;
    let correctAnswers = 0;
    let wrongAnswers = 0;
    let timeRemaining = 300;
    let timerInterval = null;
    let levelStartTime = null;
    let currentQuestions = [];
    let openPhases = [];

    // ==================== Badge Functions ====================
    function hasBadge(badgeName) {
      if (!currentPlayer || !currentPlayer.badges) return false;
      return currentPlayer.badges.split(',').filter(b => b).includes(badgeName);
    }

    function renderBadges() {
      const container = document.getElementById('badges-container');
      if (!container) return;

      const earnedBadges = currentPlayer && currentPlayer.badges ? currentPlayer.badges.split(',').filter(b => b) : [];
      const badgeCount = document.getElementById('badge-count');
      if (badgeCount) badgeCount.textContent = `(${earnedBadges.length}/17)`;

      container.innerHTML = Object.entries(badgeDefinitions).map(([key, badge]) => {
        const isEarned = earnedBadges.includes(key);
        return `
          <div class="badge-item text-center ${isEarned ? '' : 'opacity-30'} transition-all cursor-pointer" 
               onclick="showBadgeInfo('${key}')" 
               title="${badge.description}">
            <div class="w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-gradient-to-br ${badge.gradient} flex items-center justify-center text-2xl sm:text-3xl mx-auto mb-2 ${isEarned ? 'badge-glow' : ''}">
              ${badge.icon}
            </div>
            <p class="text-xs font-semibold">${badge.name}</p>
          </div>
        `;
      }).join('');
    }

    function showBadgeInfo(badgeKey) {
      playClickSound();
      const badge = badgeDefinitions[badgeKey];
      const isEarned = hasBadge(badgeKey);
      showToast(isEarned ? `ğŸ… ${badge.name}: ${badge.description}` : `ğŸ”’ ${badge.name}: ${badge.description}`, isEarned ? 'success' : 'info');
    }

    async function addBadge(badgeName) {
      if (!currentPlayer || !getStorage() || !badgeDefinitions[badgeName]) return;
      if (hasBadge(badgeName)) return;

      const badges = currentPlayer.badges ? currentPlayer.badges.split(',').filter(b => b) : [];
      badges.push(badgeName);
      currentPlayer.badges = badges.join(',');

      const result = await getStorage().update(currentPlayer);
      if (!result.isOk) {
        showToast('Gagal menyimpan badge', 'error');
        return;
      }

      const badge = badgeDefinitions[badgeName];
      document.getElementById('badge-icon-notif').textContent = badge.icon;
      document.getElementById('badge-name-notif').textContent = badge.name;
      document.getElementById('badge-desc-notif').textContent = badge.description;
      document.getElementById('badge-notification').classList.remove('hidden');

      renderBadges();
      showToast(`ğŸ… Badge baru: ${badge.name}!`, 'success');
    }

    function closeBadgeNotification() {
      document.getElementById('badge-notification').classList.add('hidden');
    }

    // ==================== Activity Tracking ====================
    async function trackVideoWatch() {
      if (!currentPlayer || !getStorage()) return;

      currentPlayer.video_watched = (currentPlayer.video_watched || 0) + 1;
      await getStorage().update(currentPlayer);

      if (currentPlayer.video_watched >= 1 && !hasBadge('video_watcher')) {
        await addBadge('video_watcher');
      }
    }

    async function trackMaterialRead(materialKey) {
      if (!currentPlayer || !getStorage()) return;

      const readMaterials = currentPlayer.materials_read ? currentPlayer.materials_read.split(',').filter(m => m) : [];
      if (!readMaterials.includes(materialKey)) {
        readMaterials.push(materialKey);
        currentPlayer.materials_read = readMaterials.join(',');
        await getStorage().update(currentPlayer);

        if (readMaterials.length >= 3 && !hasBadge('material_reader')) {
          await addBadge('material_reader');
        }
      }
    }

    async function trackExperiment() {
      if (!currentPlayer || !getStorage()) return;

      currentPlayer.experiments_done = (currentPlayer.experiments_done || 0) + 1;
      await getStorage().update(currentPlayer);

      if (currentPlayer.experiments_done >= 5 && !hasBadge('experimenter')) {
        await addBadge('experimenter');
      }
    }

    async function checkBadgesAfterLevel(level, score, timeTaken) {
      // Level completion badges
      if (level === 1 && !hasBadge('learner')) await addBadge('learner');
      if (level === 2 && !hasBadge('thinker')) await addBadge('thinker');
      if (level === 3 && !hasBadge('master')) await addBadge('master');

      // Score badges
      if (score === 1000 && !hasBadge('perfectionist')) await addBadge('perfectionist');
      if (score >= 900 && !hasBadge('champion')) await addBadge('champion');
      if (score >= 800 && timeTaken < 180 && !hasBadge('speedster')) await addBadge('speedster');

      // Check three star (all levels completed with 1000+ score)
      const completedLevels = [
        (currentPlayer.level_1_score || 0) >= 1000,
        (currentPlayer.level_2_score || 0) >= 1000,
        (currentPlayer.level_3_score || 0) >= 1000
      ].filter(Boolean).length;

      if (completedLevels >= 3 && !hasBadge('three_star')) await addBadge('three_star');

      // Check perfect trilogy (all levels >= 800 score)
      if ((currentPlayer.level_1_score || 0) >= 800 &&
        (currentPlayer.level_2_score || 0) >= 800 &&
        (currentPlayer.level_3_score || 0) >= 800 &&
        !hasBadge('perfect_trilogy')) {
        await addBadge('perfect_trilogy');
      }

      // Persistent badge
      if ((currentPlayer.total_questions || 0) >= 50 && !hasBadge('persistent')) {
        await addBadge('persistent');
      }

      // Accurate badge
      if ((currentPlayer.correct_streak || 0) >= 10 && !hasBadge('accurate')) {
        await addBadge('accurate');
      }

      // Comeback kid badge (check if retrying a level)
      const attempts = currentPlayer.level_attempts ? currentPlayer.level_attempts.split(',').filter(a => a) : [];
      const levelAttempts = attempts.filter(a => a.startsWith(`level${level}`)).length;
      if (levelAttempts > 1 && !hasBadge('comeback_kid')) {
        await addBadge('comeback_kid');
      }
    }

    // ==================== Material Functions ====================
    function showMaterial(type) {
      document.querySelectorAll('.material-tab').forEach(tab => {
        tab.classList.remove('bg-purple-500');
        tab.classList.add('bg-white/10');
      });
      document.querySelector(`.material-tab[data-tab="${type}"]`).classList.remove('bg-white/10');
      document.querySelector(`.material-tab[data-tab="${type}"]`).classList.add('bg-purple-500');

      document.getElementById('material-content').innerHTML = materials[type];
      const videoContainer = document.getElementById('video-content');
      if (videoContainer) {
        videoContainer.innerHTML = videos[type] || '';
      }

      trackMaterialRead(type);
    }

    // ==================== Explorer Mode Functions ====================
    function setExplorerMode(mode) {
      // Update button styles
      document.querySelectorAll('.explorer-mode-btn').forEach(btn => {
        btn.classList.remove('bg-indigo-500', 'bg-yellow-500', 'bg-purple-500');
        btn.classList.add('bg-white/10');
      });

      // Hide all explorer contents
      document.querySelectorAll('.explorer-content').forEach(content => {
        content.classList.add('hidden');
      });

      // Show selected mode
      if (mode === 'basic') {
        document.getElementById('mode-basic').classList.remove('bg-white/10');
        document.getElementById('mode-basic').classList.add('bg-indigo-500');
        document.getElementById('explorer-basic').classList.remove('hidden');
        calculateExponent();
      } else if (mode === 'zero-negative') {
        document.getElementById('mode-zero-negative').classList.remove('bg-white/10');
        document.getElementById('mode-zero-negative').classList.add('bg-yellow-500');
        document.getElementById('explorer-zero-negative').classList.remove('hidden');
        calculateZeroNegative();
      } else if (mode === 'fraction-root') {
        document.getElementById('mode-fraction-root').classList.remove('bg-white/10');
        document.getElementById('mode-fraction-root').classList.add('bg-purple-500');
        document.getElementById('explorer-fraction-root').classList.remove('hidden');
        calculateFractionRoot();
      }
    }

    function calculateExponent() {
      const base = parseFloat(document.getElementById('exp-base').value) || 2;
      const power = parseFloat(document.getElementById('exp-power').value) || 1;

      let result, explanation, calculation;

      if (power === 0) {
        result = 1;
        calculation = `${base}2â»Â² = 1`;
        explanation = "Setiap bilangan (selain 0) pangkat 0 sama dengan 1";
      } else if (power < 0) {
        result = Math.pow(base, power);
        calculation = `${base}^(${power}) = 1/${base}^${Math.abs(power)} = ${result.toFixed(4)}`;
        explanation = `Pangkat negatif berarti 1 dibagi dengan bilangan tersebut pangkat positif`;
      } else if (power % 1 !== 0) {
        result = Math.pow(base, power);
        calculation = `${base}^(${power}) Ã— ${result.toFixed(4)}`;
        explanation = `Pangkat pecahan berkaitan dengan akar bilangan`;
      } else {
        result = Math.pow(base, power);
        const multiplication = Array(Math.min(power, 5)).fill(base).join(' Ã— ') + (power > 5 ? '...' : '');
        calculation = `${base}^${power} = ${multiplication} = ${result}`;
        explanation = `Artinya: ${base} dikalikan dengan dirinya sendiri sebanyak ${power} kali`;
      }

      document.getElementById('exp-result').textContent = calculation;
      document.getElementById('exp-explanation').textContent = explanation;

      trackExperiment();
    }

    function calculateZeroNegative() {
      const base = parseFloat(document.getElementById('zn-base').value) || 2;
      const power = parseInt(document.getElementById('zn-power').value) || 0;

      let result, calculation, explanation;

      if (base === 0 && power <= 0) {
        calculation = `0^${power} tidak terdefinisi`;
        explanation = "0 pangkat 0 atau 0 pangkat negatif tidak terdefinisi dalam matematika";
      } else if (power === 0) {
        result = 1;
        calculation = `${base}2â»Â² = 1`;
        explanation = `Setiap bilangan (selain 0) pangkat 0 = 1. Ini adalah aturan dasar perpangkatan!`;
      } else if (power < 0) {
        const positivePower = Math.abs(power);
        const denominatorValue = Math.pow(base, positivePower);
        result = 1 / denominatorValue;

        if (Number.isInteger(denominatorValue) && denominatorValue < 1000) {
          calculation = `${base}^(${power}) = 1/${base}^${positivePower} = 1/${denominatorValue}`;
        } else {
          calculation = `${base}^(${power}) = 1/${base}^${positivePower} Ã— ${result.toFixed(6)}`;
        }

        if (result >= 0.0001) {
          explanation = `Pangkat negatif = kebalikan dari pangkat positif. ${base}^(${power}) = 12â»Â² ${base}^${positivePower}`;
        } else {
          explanation = `Nilai sangat kecil! Ini seperti ukuran mikroskopis (nano, mikro). Dalam notasi ilmiah: ${result.toExponential(2)}`;
        }
      } else {
        result = Math.pow(base, power);
        calculation = `${base}^${power} = ${result}`;
        explanation = `Perpangkatan positif biasa: ${base} dikalikan ${power} kali`;
      }

      document.getElementById('zn-result').textContent = calculation;
      document.getElementById('zn-explanation').textContent = explanation;

      trackExperiment();
    }

    function formatFractionHTML(numerator, denominator) {
      return `<span class="frac"><span class="num">${numerator}</span><span class="bar"></span><span class="den">${denominator}</span></span>`;
    }

    function formatPowerWithFractionHTML(base, numerator, denominator) {
      return `${base}<sup class="sup-frac">${formatFractionHTML(numerator, denominator)}</sup>`;
    }

    function formatMathText(text) {
      if (!text) return '';
      let formatted = text.replace(/(\d+)\^\((\d+)\/(\d+)\)/g, (match, base, numerator, denominator) => {
        return `${base}<sup class="sup-frac">${formatFractionHTML(numerator, denominator)}</sup>`;
      });
      formatted = formatted.replace(/(\d+)\/(\d+)/g, (match, numerator, denominator) => {
        return formatFractionHTML(numerator, denominator);
      });
      return formatted;
    }

    function calculateFractionRoot() {
      const base = parseFloat(document.getElementById('fr-base').value) || 16;
      const numerator = parseInt(document.getElementById('fr-numerator').value) || 1;
      const denominator = parseInt(document.getElementById('fr-denominator').value) || 2;

      if (denominator === 0) {
        document.getElementById('fr-result').innerHTML = "Error: Penyebut tidak boleh 0";
        document.getElementById('fr-explanation').innerHTML = "Pembagian dengan nol tidak terdefinisi";
        return;
      }

      if (base < 0 && denominator % 2 === 0) {
        document.getElementById('fr-result').innerHTML = "Error: Akar genap dari bilangan negatif";
        document.getElementById('fr-explanation').innerHTML = "Dalam bilangan real, tidak bisa menghitung akar genap dari bilangan negatif";
        return;
      }

      const fraction = numerator / denominator;
      const result = Math.pow(base, fraction);

      let calculation = '';
      let explanation = '';

      // Format the display
      const exponentHTML = formatPowerWithFractionHTML(base, numerator, denominator);

      if (numerator === 1) {
        // Simple root case
        const rootSymbol = denominator === 2 ? 'v' : `${getSuperscript(denominator)}v`;
        const simpleExponentHTML = formatPowerWithFractionHTML(base, 1, denominator);
        calculation = `${simpleExponentHTML} = ${rootSymbol}${base} = ${result.toFixed(4)}`;

        if (Number.isInteger(result)) {
          calculation = `${simpleExponentHTML} = ${rootSymbol}${base} = ${Math.round(result)}`;
          explanation = `${base} pangkat ${formatFractionHTML(1, denominator)} sama dengan akar pangkat ${denominator} dari ${base}`;
        } else {
          explanation = `${base} pangkat ${formatFractionHTML(1, denominator)} sama dengan akar pangkat ${denominator} dari ${base} (2â»Â² ${result.toFixed(4)})`;
        }
      } else {
        // Complex fraction case
        const rootValue = Math.pow(base, 1 / denominator);
        const finalResult = Math.pow(rootValue, numerator);

        const rootSymbol = denominator === 2 ? 'v' : `${getSuperscript(denominator)}v`;
        const rootBaseHTML = `${rootSymbol}${base}`;
        const rootPowerHTML = `(${rootBaseHTML})<sup>${numerator}</sup>`;

        if (Number.isInteger(result)) {
          calculation = `${exponentHTML} = ${rootPowerHTML} = ${Math.round(result)}`;
        } else {
          calculation = `${exponentHTML} = ${rootPowerHTML} Ã— ${result.toFixed(4)}`;
        }

        explanation = `Ada 2 cara: (1) Akar dulu: ${rootPowerHTML} ATAU (2) Pangkat dulu: ${rootSymbol}(${base}<sup>${numerator}</sup>)`;
      }

      document.getElementById('fr-result').innerHTML = calculation;
      document.getElementById('fr-explanation').innerHTML = explanation;

      trackExperiment();
    }

    function setFractionExample(base, num, den) {
      document.getElementById('fr-base').value = base;
      document.getElementById('fr-numerator').value = num;
      document.getElementById('fr-denominator').value = den;
      calculateFractionRoot();
    }

    function getSuperscript(n) {
      const superscripts = {
        '0': '2â»Â²', '1': '2â»Â²', '2': '2â»Â²', '3': '2â»Â²', '4': '4',
        '5': '5', '6': '6', '7': '7', '8': '8', '9': '?'
      };
      return n.toString().split('').map(d => superscripts[d] || d).join('');
    }

    // ==================== Inquiry Functions ====================
    async function togglePhase(phaseId) {
      const content = document.getElementById(`${phaseId}-content`);
      const icon = document.getElementById(`${phaseId}-icon`);

      if (content.classList.contains('hidden')) {
        content.classList.remove('hidden');
        icon.textContent = '?';

        if (!openPhases.includes(phaseId)) {
          openPhases.push(phaseId);
        }

        // Track inquiry master badge
        if (currentPlayer && openPhases.length >= 5 && !hasBadge('inquiry_master')) {
          await addBadge('inquiry_master');
        }
      } else {
        content.classList.add('hidden');
        icon.textContent = '?';
        openPhases = openPhases.filter(p => p !== phaseId);
      }
    }

    function toggleGuideItem(itemId) {
      const content = document.getElementById(`${itemId}-content`);
      const icon = document.getElementById(`${itemId}-icon`);

      if (content.classList.contains('hidden')) {
        content.classList.remove('hidden');
        icon.textContent = 'â–';
      } else {
        content.classList.add('hidden');
        icon.textContent = 'â•';
      }
    }

    // ==================== Player Functions ====================
    async function registerPlayer() {
      const nameInput = document.getElementById('player-name-input');
      const name = nameInput.value.trim();

      if (!name) {
        showToast('Masukkan nama kamu dulu!', 'warning');
        return;
      }

      // Check if player exists in Supabase
      if (getStorage()) {
        console.log('Checking if player exists:', name);
        const readResult = await getStorage().read({ player_name: name });
        console.log('Read result:', readResult);
        if (readResult.isOk && readResult.data && readResult.data.length > 0) {
          // Player exists - load fresh data from Supabase
          currentPlayer = readResult.data[0];
          console.log('Existing player loaded:', currentPlayer);
          showToast(`Selamat datang kembali, ${name}! ğŸ‘‹`, 'success');
          updatePlayerUI();
          return;
        }
        console.log('Player not found, creating new...');
      }

      if (allPlayers.length >= 999) {
        showToast('Maaf, batas maksimal pemain sudah tercapai (999 pemain)', 'error');
        return;
      }

      const newPlayer = {
        player_name: name,
        total_score: 0,
        level_1_score: 0,
        level_2_score: 0,
        level_3_score: 0,
        game_played: 0,
        correct_answers: 0,
        wrong_answers: 0,
        average_score: 0,
        badges: '',
        video_watched: 0,
        materials_read: '',
        experiments_done: 0,
        total_questions: 0,
        correct_streak: 0,
        inquiry_phases_read: '',
        level_attempts: '',
        cptp_read: false,
        created_at: new Date().toISOString()
      };

      if (getStorage()) {
        const result = await getStorage().create(newPlayer);
        if (result.isOk) {
          // Get the created record with id from Supabase
          const createdRecord = result.data;
          currentPlayer = {
            ...newPlayer,
            id: createdRecord.id,
            __backendId: createdRecord.id
          };
          allPlayers.push(currentPlayer);
          console.log('New player created with id:', currentPlayer.id, currentPlayer);
          showToast(`Selamat datang, ${name}! ğŸ‰`, 'success');
          updatePlayerUI();
          await addBadge('explorer');
        } else {
          showToast('Gagal mendaftar. Coba lagi!', 'error');
          console.error('Create player failed:', result.error);
        }
      }
    }

    function updatePlayerUI() {
      if (!currentPlayer) return;

      document.getElementById('player-registration').innerHTML = `
        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center text-2xl font-bold">
              ${currentPlayer.player_name.charAt(0).toUpperCase()}
            </div>
            <div>
              <p class="font-bold text-lg">${currentPlayer.player_name}</p>
              <p class="text-sm text-gray-400">Total Skor: ${currentPlayer.total_score || 0}</p>
            </div>
          </div>
          <button onclick="logoutPlayer()" class="px-4 py-2 bg-white/10 rounded-lg hover:bg-white/20 transition-colors text-sm">
            Keluar
          </button>
        </div>
      `;

      document.getElementById('total-score-display').textContent = currentPlayer.total_score || 0;
      document.getElementById('user-score').classList.remove('hidden');

      // Update player statistics display
      document.getElementById('stat-total-score').textContent = currentPlayer.total_score || 0;
      document.getElementById('stat-games-played').textContent = currentPlayer.game_played || 0;
      document.getElementById('stat-correct-answers').textContent = currentPlayer.correct_answers || 0;
      document.getElementById('stat-wrong-answers').textContent = currentPlayer.wrong_answers || 0;
      document.getElementById('stat-average-score').textContent = (currentPlayer.average_score || 0).toFixed(1);

      // Update level cards
      updateLevelCards();
      renderBadges();
    }

    function updateLevelCards() {
      if (!currentPlayer) return;

      console.log('Updating level cards with player data:', {
        player_name: currentPlayer.player_name,
        level_1_score: currentPlayer.level_1_score,
        level_2_score: currentPlayer.level_2_score,
        level_3_score: currentPlayer.level_3_score,
        total_score: currentPlayer.total_score
      });

      // Level 1
      const level1Card = document.getElementById('level-1-card');
      const level1Score = currentPlayer.level_1_score || 0;
      const level1Completed = level1Score >= 1000;

      document.getElementById('level-1-score').textContent = `${level1Score}/1000`;
      document.getElementById('level-1-progress').style.width = `${Math.min((level1Score / 1000) * 100, 100)}%`;

      if (level1Completed) {
        document.getElementById('level-1-status').textContent = 'âœ… Selesai';
        document.getElementById('level-1-status').className = 'px-3 py-1 bg-green-500/30 rounded-full text-xs font-bold';
      } else {
        document.getElementById('level-1-status').textContent = 'Tersedia';
        document.getElementById('level-1-status').className = 'px-3 py-1 bg-cyan-500/30 rounded-full text-xs font-bold';
      }

      // Level 2
      const level2Card = document.getElementById('level-2-card');
      const level2Score = currentPlayer.level_2_score || 0;
      const level2Completed = level2Score >= 1000;

      if (level1Completed) {
        level2Card.classList.remove('locked', 'opacity-50', 'cursor-not-allowed');
        level2Card.classList.add('cursor-pointer');

        if (level2Completed) {
          document.getElementById('level-2-status').textContent = 'âœ… Selesai';
          document.getElementById('level-2-status').className = 'px-3 py-1 bg-green-500/30 rounded-full text-xs font-bold';
        } else {
          document.getElementById('level-2-status').textContent = 'Tersedia';
          document.getElementById('level-2-status').className = 'px-3 py-1 bg-yellow-500/30 rounded-full text-xs font-bold';
        }
      } else {
        document.getElementById('level-2-status').textContent = 'ğŸ”’ Terkunci';
        document.getElementById('level-2-status').className = 'px-3 py-1 bg-gray-500/30 rounded-full text-xs font-bold';
      }

      document.getElementById('level-2-score').textContent = `${level2Score}/1000`;
      document.getElementById('level-2-progress').style.width = `${Math.min((level2Score / 1000) * 100, 100)}%`;

      // Level 3
      const level3Card = document.getElementById('level-3-card');
      const level3Score = currentPlayer.level_3_score || 0;
      const level3Completed = level3Score >= 1000;

      if (level2Completed) {
        level3Card.classList.remove('locked', 'opacity-50', 'cursor-not-allowed');
        level3Card.classList.add('cursor-pointer');

        if (level3Completed) {
          document.getElementById('level-3-status').textContent = 'âœ… Selesai';
          document.getElementById('level-3-status').className = 'px-3 py-1 bg-green-500/30 rounded-full text-xs font-bold';
        } else {
          document.getElementById('level-3-status').textContent = 'Tersedia';
          document.getElementById('level-3-status').className = 'px-3 py-1 bg-purple-500/30 rounded-full text-xs font-bold';
        }
      } else {
        document.getElementById('level-3-status').textContent = 'ğŸ”’ Terkunci';
        document.getElementById('level-3-status').className = 'px-3 py-1 bg-gray-500/30 rounded-full text-xs font-bold';
      }

      document.getElementById('level-3-score').textContent = `${level3Score}/1000`;
      document.getElementById('level-3-progress').style.width = `${Math.min((level3Score / 1000) * 100, 100)}%`;
    }

    function logoutPlayer() {
      currentPlayer = null;
      location.reload();
    }

    // ==================== Game Functions ====================
    let currentHypothesis = '';
    let isHintViewed = false;

    function toggleHint() {
      const hintSection = document.getElementById('hint-section');
      const hintButton = document.getElementById('hint-button');

      if (hintSection.classList.contains('hidden')) {
        hintSection.classList.remove('hidden');
        hintButton.textContent = 'ğŸ™ˆ Sembunyikan Hint';
        isHintViewed = true;
      } else {
        hintSection.classList.add('hidden');
        hintButton.textContent = 'ğŸ’¡ Lihat Hint';
      }
    }

    function saveHypothesis() {
      playClickSound();
      const hypothesisInput = document.getElementById('hypothesis-input');
      currentHypothesis = hypothesisInput.value.trim();

      if (!currentHypothesis) {
        showToast('Tuliskan hipotesismu terlebih dahulu!', 'warning');
        return;
      }

      // Save hypothesis to player data
      if (currentPlayer && getStorage()) {
        currentPlayer.hypotheses_written = (currentPlayer.hypotheses_written || 0) + 1;
      }

      // Show options section
      document.getElementById('options-section').classList.remove('hidden');
      document.getElementById('save-hypothesis-btn').disabled = true;
      document.getElementById('save-hypothesis-btn').classList.add('opacity-50', 'cursor-not-allowed');
      hypothesisInput.disabled = true;

      showToast('Hipotesis tersimpan! Silakan pilih jawaban ğŸ‘', 'success');
    }

    function startLevel(level) {
      playClickSound();
      if (!currentPlayer) {
        showToast('Daftar dulu sebelum bermain!', 'warning');
        return;
      }

      // Check if level is unlocked based on score
      if (level === 2 && (currentPlayer.level_1_score || 0) < 1000) {
        showToast('Selesaikan Level 1 dengan skor minimal 1000 terlebih dahulu!', 'warning');
        return;
      }

      if (level === 3 && (currentPlayer.level_2_score || 0) < 1000) {
        showToast('Selesaikan Level 2 dengan skor minimal 1000 terlebih dahulu!', 'warning');
        return;
      }

      currentLevel = level;
      currentQuestionIndex = 0;
      levelScore = 0;
      correctAnswers = 0;
      wrongAnswers = 0;
      timeRemaining = 300;
      levelStartTime = Date.now();

      // Shuffle questions
      currentQuestions = [...questionBank[level]].sort(() => Math.random() - 0.5);

      // Track level attempt
      const attempts = currentPlayer.level_attempts ? currentPlayer.level_attempts.split(',').filter(a => a) : [];
      attempts.push(`level${level}_${Date.now()}`);
      currentPlayer.level_attempts = attempts.join(',');

      showSection('game');

      const levelTitles = {
        1: 'Perpangkatan Dasar',
        2: 'Pangkat Nol & Negatif',
        3: 'Pangkat Pecahan & Akar'
      };

      document.getElementById('current-level-display').textContent = level;
      document.getElementById('level-title').textContent = levelTitles[level];
      document.getElementById('game-score').textContent = '0';
      document.getElementById('correct-count').textContent = '0';
      document.getElementById('wrong-count').textContent = '0';

      loadQuestion();
      startTimer();
      playQuestionBgm();
    }

    function loadQuestion() {
      if (currentQuestionIndex >= currentQuestions.length) {
        endLevel();
        return;
      }

      const question = currentQuestions[currentQuestionIndex];

      // Reset hypothesis section
      currentHypothesis = '';
      isHintViewed = false;
      document.getElementById('hypothesis-input').value = '';
      document.getElementById('hypothesis-input').disabled = false;
      document.getElementById('save-hypothesis-btn').disabled = false;
      document.getElementById('save-hypothesis-btn').classList.remove('opacity-50', 'cursor-not-allowed');
      document.getElementById('options-section').classList.add('hidden');
      document.getElementById('hint-section').classList.add('hidden');
      document.getElementById('hint-button').textContent = 'ğŸ’¡ Lihat Hint';

      // Load question content
      document.getElementById('current-question-num').textContent = currentQuestionIndex + 1;
      document.getElementById('question-progress').style.width = `${((currentQuestionIndex + 1) / currentQuestions.length) * 100}%`;
      document.getElementById('orientation-text').textContent = question.orientation || 'Pahami konteks masalah ini dengan baik.';
      document.getElementById('question-text').innerHTML = formatMathText(question.q);
      document.getElementById('hint-text').textContent = question.hint || 'Pikirkan langkah-langkah penyelesaiannya.';
      document.getElementById('feedback-container').classList.add('hidden');

      const optionsContainer = document.getElementById('options-container');
      optionsContainer.innerHTML = question.options.map((option, index) => `
        <button onclick="checkAnswer(${index})" class="option-btn w-full bg-gradient-to-r from-indigo-500/20 to-purple-500/20 border border-indigo-500/30 rounded-xl p-4 text-left hover:bg-indigo-500/30 transition-all">
          <span class="font-bold text-indigo-300">${String.fromCharCode(65 + index)}.</span> ${formatMathText(option)}
        </button>
      `).join('');
    }

    function checkAnswer(selectedIndex) {
      playClickSound();
      const question = currentQuestions[currentQuestionIndex];
      const isCorrect = selectedIndex === question.correct;

      // Disable all buttons
      document.querySelectorAll('.option-btn').forEach(btn => btn.disabled = true);

      // Update stats
      if (isCorrect) {
        correctAnswers++;
        levelScore += 100;
        currentPlayer.correct_streak = (currentPlayer.correct_streak || 0) + 1;
        document.getElementById('correct-count').textContent = correctAnswers;
        showFeedback(true, question.explanation);
      } else {
        wrongAnswers++;
        currentPlayer.correct_streak = 0;
        document.getElementById('wrong-count').textContent = wrongAnswers;
        showFeedback(false, question.explanation);
      }

      currentPlayer.total_questions = (currentPlayer.total_questions || 0) + 1;
      document.getElementById('game-score').textContent = levelScore;

      setTimeout(() => {
        currentQuestionIndex++;
        loadQuestion();
      }, 3000);
    }

    function showFeedback(isCorrect, explanation) {
      const container = document.getElementById('feedback-container');
      container.classList.remove('hidden');

      if (isCorrect) {
        container.className = 'rounded-xl p-6 mb-6 bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-500/30';
        document.getElementById('feedback-title').textContent = 'âœ“ Benar!';
        document.getElementById('feedback-title').className = 'text-xl font-bold mb-2 text-green-400';
      } else {
        container.className = 'rounded-xl p-6 mb-6 bg-gradient-to-r from-red-500/20 to-rose-500/20 border border-red-500/30';
        document.getElementById('feedback-title').textContent = 'X Salah';
        document.getElementById('feedback-title').className = 'text-xl font-bold mb-2 text-red-400';
      }

      document.getElementById('feedback-text').innerHTML = formatMathText(explanation);
    }

    function startTimer() {
      if (timerInterval) clearInterval(timerInterval);

      timerInterval = setInterval(() => {
        timeRemaining--;

        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        const timerDisplay = document.getElementById('timer-display');
        timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;

        if (timeRemaining <= 60) {
          timerDisplay.classList.add('timer-warning', 'text-red-400');
        }

        if (timeRemaining <= 0) {
          clearInterval(timerInterval);
          endLevel();
        }
      }, 1000);
    }

    async function endLevel() {
      clearInterval(timerInterval);
      stopQuestionBgm();

      const timeTaken = Math.floor((Date.now() - levelStartTime) / 1000);
      const timeBonus = Math.max(0, Math.floor((300 - timeTaken) / 10) * 10);
      const finalScore = levelScore + timeBonus;

      // Update player data - keep highest score
      const currentLevelScore = currentPlayer[`level_${currentLevel}_score`] || 0;
      currentPlayer[`level_${currentLevel}_score`] = Math.max(currentLevelScore, finalScore);

      // Recalculate total score
      currentPlayer.total_score = (currentPlayer.level_1_score || 0) +
        (currentPlayer.level_2_score || 0) +
        (currentPlayer.level_3_score || 0);

      // Update game statistics
      currentPlayer.game_played = (currentPlayer.game_played || 0) + 1;
      currentPlayer.correct_answers = (currentPlayer.correct_answers || 0) + correctAnswers;
      currentPlayer.wrong_answers = (currentPlayer.wrong_answers || 0) + wrongAnswers;

      // Calculate average score
      const totalGames = currentPlayer.game_played || 1;
      currentPlayer.average_score = Math.round(currentPlayer.total_score / totalGames);

      console.log('Level finished:', {
        level: currentLevel,
        finalScore,
        correctAnswers,
        wrongAnswers,
        game_played: currentPlayer.game_played,
        correct_answers: currentPlayer.correct_answers,
        wrong_answers: currentPlayer.wrong_answers,
        total_score: currentPlayer.total_score,
        average_score: currentPlayer.average_score
      });

      // Save to Supabase
      if (getStorage()) {
        console.log('Saving player data to Supabase:', currentPlayer);
        const result = await getStorage().update(currentPlayer);
        if (result.isError) {
          console.error('Failed to save score:', result.error);
          showToast('Gagal menyimpan skor. Silakan coba lagi.', 'error');
          return;
        }
        console.log('Save successful, refreshing data...');
        // Refresh player data from database
        const readResult = await getStorage().read({ player_name: currentPlayer.player_name });
        if (readResult.isOk && readResult.data && readResult.data.length > 0) {
          currentPlayer = readResult.data[0];
          console.log('Player data refreshed from Supabase:', currentPlayer);
        }
      }

      // Check for badges
      await checkBadgesAfterLevel(currentLevel, finalScore, timeTaken);

      // Show results
      showSection('home');
      updatePlayerUI();

      showToast(`Level ${currentLevel} selesai! Skor: ${finalScore} (Bonus waktu: ${timeBonus})`, 'success');
    }

    function exitGame() {
      clearInterval(timerInterval);
      stopQuestionBgm();
      showSection('home');
    }

    // ==================== Section Navigation ====================
    function showSection(sectionName) {
      document.querySelectorAll('section').forEach(section => {
        section.classList.add('hidden');
      });
      document.getElementById(`${sectionName}-section`).classList.remove('hidden');

      if (sectionName !== 'game') {
        stopQuestionBgm();
      }

      if (sectionName === 'leaderboard') {
        renderLeaderboard();
      }

      // Track CP/TP visit
      if (sectionName === 'cptp' && currentPlayer && !currentPlayer.cptp_read) {
        trackCPTPRead();
      }
    }

    async function trackCPTPRead() {
      if (!currentPlayer || !getStorage()) return;

      currentPlayer.cptp_read = true;
      await getStorage().update(currentPlayer);

      if (!hasBadge('scholar')) {
        await addBadge('scholar');
      }
    }

    function renderLeaderboard() {
      const container = document.getElementById('leaderboard-content');
      if (!container) return;

      const sortedPlayers = [...allPlayers].sort((a, b) => (b.total_score || 0) - (a.total_score || 0));

      if (sortedPlayers.length === 0) {
        container.innerHTML = '<p class="text-gray-400 text-center py-8">Belum ada pemain yang terdaftar</p>';
        return;
      }

      container.innerHTML = sortedPlayers.slice(0, 10).map((player, index) => {
        const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
        const medal = index < 3 ? medals[index] : `${index + 1}.`;
        const badgeCount = player.badges ? player.badges.split(',').filter(b => b).length : 0;

        return `
          <div class="card-glass rounded-xl p-4 flex items-center justify-between">
            <div class="flex items-center gap-4">
              <div class="text-3xl w-12 text-center">${medal}</div>
              <div>
                <p class="font-bold text-lg">${player.player_name}</p>
                <p class="text-sm text-gray-400">ğŸ… ${badgeCount} badges</p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-2xl font-bold text-yellow-400">${player.total_score || 0}</p>
              <p class="text-xs text-gray-400">
                L1: ${player.level_1_score || 0} | 
                L2: ${player.level_2_score || 0} | 
                L3: ${player.level_3_score || 0}
              </p>
            </div>
          </div>
        `;
      }).join('');
    }

    // ==================== Toast Function ====================
    function showToast(message, type = 'info') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');

      const colors = {
        success: 'from-green-500 to-emerald-500',
        error: 'from-red-500 to-rose-500',
        info: 'from-blue-500 to-cyan-500',
        warning: 'from-yellow-500 to-orange-500'
      };

      toast.className = `toast bg-gradient-to-r ${colors[type]} px-4 py-3 rounded-lg shadow-lg text-sm font-medium`;
      toast.textContent = message;
      container.appendChild(toast);

      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transition = 'opacity 0.3s';
        setTimeout(() => toast.remove(), 300);
      }, 4000);
    }

    // ==================== Data SDK Handler ====================
    const dataHandler = {
      onDataChanged(data) {
        allPlayers = data;

        if (currentPlayer) {
          const updatedPlayer = data.find(p => p.__backendId === currentPlayer.__backendId);
          if (updatedPlayer) {
            currentPlayer = updatedPlayer;
            updatePlayerUI();
          }
        }
      }
    };

    // ==================== Initialization ====================
    async function initApp() {
      try {
        // Initialize Supabase storage with offline fallback
        if (window.hybridStorageManager) {
          const initResult = await window.hybridStorageManager.init(dataHandler);
          if (!initResult.isOk) {
            console.warn('[XnRoot] Storage init had issues, but continuing...');
          } else {
            console.log('[XnRoot] Supabase storage initialized successfully');
          }
        } else {
          console.error('[XnRoot] Hybrid storage manager not available!');
        }

        // Initialize material display
        showMaterial('dasar');
        renderBadges();

        // Update storage stats
        await updateStorageStats();

        setTimeout(() => {
          document.getElementById('loading-screen').style.display = 'none';
          console.log('[XnRoot] App ready!');
        }, 800);
      } catch (error) {
        console.error('[XnRoot] Init error:', error);
        document.getElementById('loading-screen').style.display = 'none';
        showToast('Aplikasi siap digunakan!', 'info');
      }
    }

    // ==================== Storage Manager Functions ====================
    async function updateStorageStats() {
      if (window.hybridStorageManager) {
        const stats = await window.hybridStorageManager.getStats();
        document.getElementById('storage-total-players').textContent = stats.totalPlayers || 0;
      }
    }

    async function refreshCurrentPlayerStats() {
      if (!currentPlayer) {
        showToast('Silakan login terlebih dahulu!', 'warning');
        return;
      }

      try {
        showToast('Memuat data terbaru...', 'info');

        // Read latest data from Supabase for current player
        const result = await getStorage().read({ player_name: currentPlayer.player_name });

        if (result.isOk && result.data && result.data.length > 0) {
          currentPlayer = result.data[0];
          updatePlayerUI();
          showToast('Data berhasil diperbarui! ğŸ”„', 'success');
        } else {
          showToast('Data pemain tidak ditemukan!', 'error');
        }
      } catch (error) {
        console.error('Refresh error:', error);
        showToast('Gagal refresh data: ' + error.message, 'error');
      }
    }

    async function resetPlayerStats() {
      if (!currentPlayer) {
        showToast('Silakan login terlebih dahulu!', 'warning');
        return;
      }

      // Konfirmasi dengan dialog
      const confirmed = confirm(
        `âš ï¸ PERINGATAN!\n\n` +
        `Apakah Anda yakin ingin mereset semua statistik?\n\n` +
        `Data yang akan direset:\n` +
        `â€¢ Total Skor: ${currentPlayer.total_score || 0}\n` +
        `â€¢ Level 1/2/3 Skor\n` +
        `â€¢ Game Dimainkan: ${currentPlayer.game_played || 0}\n` +
        `â€¢ Jawaban Benar: ${currentPlayer.correct_answers || 0}\n` +
        `â€¢ Jawaban Salah: ${currentPlayer.wrong_answers || 0}\n` +
        `â€¢ Badges\n\n` +
        `Proses ini TIDAK DAPAT dibatalkan!`
      );

      if (!confirmed) {
        showToast('Reset dibatalkan', 'info');
        return;
      }

      try {
        showToast('Mereset statistik...', 'info');

        // Reset all stats to 0
        currentPlayer.total_score = 0;
        currentPlayer.level_1_score = 0;
        currentPlayer.level_2_score = 0;
        currentPlayer.level_3_score = 0;
        currentPlayer.game_played = 0;
        currentPlayer.correct_answers = 0;
        currentPlayer.wrong_answers = 0;
        currentPlayer.average_score = 0;
        currentPlayer.badges = '';
        currentPlayer.video_watched = 0;
        currentPlayer.materials_read = '';
        currentPlayer.experiments_done = 0;
        currentPlayer.total_questions = 0;
        currentPlayer.correct_streak = 0;
        currentPlayer.inquiry_phases_read = '';
        currentPlayer.level_attempts = '';
        currentPlayer.cptp_read = false;
        currentPlayer.hypotheses_written = 0;

        // Save to Supabase
        const result = await getStorage().update(currentPlayer);

        if (result.isOk) {
          // Refresh from database
          const readResult = await getStorage().read({ player_name: currentPlayer.player_name });
          if (readResult.isOk && readResult.data && readResult.data.length > 0) {
            currentPlayer = readResult.data[0];
          }

          updatePlayerUI();
          showToast('âœ… Statistik berhasil direset!', 'success');
        } else {
          showToast('âŒ Gagal reset statistik: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('Reset error:', error);
        showToast('âŒ Gagal reset statistik!', 'error');
      }
    }

    // Start the app
    initApp();
  </script>

</body>

</html>
